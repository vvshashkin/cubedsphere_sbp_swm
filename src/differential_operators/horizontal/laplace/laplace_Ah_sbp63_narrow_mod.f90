module laplace_Ah_sbp63_narrow_mod

use abstract_laplace_mod,   only : laplace_operator_t
use grid_field_mod,         only : grid_field_t
use domain_mod,             only : domain_t
use sbp_operator_mod,       only : sbp_operator_t
use exchange_abstract_mod,  only : exchange_t
use halo_mod,               only : halo_t

implicit none
real(kind=8.0_8), parameter :: &
d010101 =(3488579749432192834647.0_8/853062500000000000000.0_8) - 43200.0_8/13649*25/12, &
d010102 =(-801487464472260200583.0_8/853062500000000000000.0_8), &
d010103 =(-107511269246879479263.0_8/10663281250000000000000.0_8), &
d010104 =(-220374545749778513709.0_8/4265312500000000000000.0_8), &
d010105 =(-853281605905492073679.0_8/8530625000000000000000.0_8), &
d010106 =(-213837620491087107723.0_8/2132656250000000000000.0_8), &
d010107 =(-170023197633151711707.0_8/1706125000000000000000.0_8), &
d010201 =(-201373469593852175253.0_8/21326562500000000000.0_8) + 43200.0_8/13649*4, &
d010203 =(76831939003273506963.0_8/853062500000000000000.0_8), &
d010204 =(557284028177155340673.0_8/4265312500000000000000.0_8), &
d010205 =(15036639677497517481.0_8/34122500000000000000.0_8), &
d010206 =(161429938957512238491.0_8/426531250000000000000.0_8), &
d010207 =(322452294262920020943.0_8/853062500000000000000.0_8), &
d010301 =(79089576406944196937499.0_8/8530625000000000000000.0_8) - 43200.0_8/13649*3, &
d010302 =(498278548626520783581.0_8/853062500000000000000.0_8), &
d010304 =(117832404972021093369.0_8/853062500000000000000.0_8), &
d010305 =(-656739334946087764443.0_8/853062500000000000000.0_8), &
d010306 =(-10679357746376204247.0_8/21326562500000000000.0_8), &
d010307 =(-108158529039623075763.0_8/213265625000000000000.0_8), &
d010401 =(-4208037713880665367429.0_8/853062500000000000000.0_8) + 43200.0_8/13649*4/3, &
d010402 =(448942151996204821731.0_8/853062500000000000000.0_8), &
d010403 =(-731843359645141250379.0_8/8530625000000000000000.0_8), &
d010405 =(517494470211478775457.0_8/853062500000000000000.0_8), &
d010406 =(259338954156716742561.0_8/1066328125000000000000.0_8), &
d010407 =(2219288476454558345493.0_8/8530625000000000000000.0_8), &
d010501 =(8160588935334555205509.0_8/8530625000000000000000.0_8) - 43200.0_8/13649*1/4, &
d010502 =(-119881726609766657967.0_8/853062500000000000000.0_8), &
d010503 =(55294733554706945223.0_8/17061250000000000000000.0_8), &
d010504 =(-399788170847073400887.0_8/1706125000000000000000.0_8), &
d010505 =(-1940936268931002346329.0_8/8530625000000000000000.0_8), &
d010506 =(-167619451814797080879.0_8/4265312500000000000000.0_8), &
d010507 =(-186214004609139292959.0_8/4265312500000000000000.0_8), &
d010601 =(493802139746843285229.0_8/8530625000000000000000.0_8), &
d010602 =(-2585150954069874676389.0_8/85306250000000000000000.0_8), &
d010603 =(2188561823255629155033.0_8/853062500000000000000000.0_8), &
d010604 =(248023538587423789821.0_8/10663281250000000000000.0_8), &
d010605 =(-28717252642545488919.0_8/853062500000000000000.0_8), &
d010606 =(22206943772706685203.0_8/533164062500000000000.0_8), &
d010607 =(285921424643231725821.0_8/4265312500000000000000.0_8), &
d010704 =(-258104956047683075199.0_8/42653125000000000000000.0_8), &
d010705 =(1098395195992870482747.0_8/8530625000000000000000.0_8), &
d010706 =(-35631224488991227509.0_8/853062500000000000000.0_8), &
d010707 =(-690461959893421592601.0_8/8530625000000000000000.0_8), &
d010805 =(-10527656880173303907.0_8/213265625000000000000.0_8), &
d010806 =(350253944495903046573.0_8/17061250000000000000000.0_8), &
d010807 =(2459793029589806329827.0_8/85306250000000000000000.0_8), &
d010905 =(373902084477215020521.0_8/85306250000000000000000.0_8), &
d010906 =(-1510375598090063026011.0_8/853062500000000000000000.0_8), &
d010907 =(-2228645246682087179091.0_8/853062500000000000000000.0_8), &
d020101 =(68626530406147824747.0_8/93851562500000000000.0_8), &
d020103 =(76831939003273506963.0_8/3754062500000000000000.0_8), &
d020104 =(557284028177155340673.0_8/18770312500000000000000.0_8), &
d020105 =(15036639677497517481.0_8/150162500000000000000.0_8), &
d020106 =(161429938957512238491.0_8/1877031250000000000000.0_8), &
d020107 =(322452294262920020943.0_8/3754062500000000000000.0_8), &
d020201 =(-176354841210075129861.0_8/187703125000000000000.0_8), &
d020203 =(-137268095064696670149.0_8/750812500000000000000.0_8), &
d020204 =(-56370482716998380913.0_8/750812500000000000000.0_8), &
d020205 =(-1801528565678670496743.0_8/3754062500000000000000.0_8), &
d020206 =(-1264091227125142349097.0_8/3754062500000000000000.0_8), &
d020207 =(-1262632160752875968427.0_8/3754062500000000000000.0_8), &
d020301 =(2454680772897965443323.0_8/37540625000000000000000.0_8), &
d020304 =(-297975054556298634831.0_8/3754062500000000000000.0_8), &
d020305 =(34840733714933009949.0_8/37540625000000000000.0_8), &
d020306 =(1792693417158462092517.0_8/3754062500000000000000.0_8), &
d020307 =(893156552640702834867.0_8/1877031250000000000000.0_8), &
d020401 =(390630248413213274991.0_8/1877031250000000000000.0_8), &
d020403 =(40859775068590002177.0_8/234628906250000000000.0_8), &
d020405 =(-320670968857568377479.0_8/375406250000000000000.0_8), &
d020406 =(-8345949222454037577.0_8/29328613281250000000.0_8), &
d020407 =(-1042213208874066000189.0_8/3754062500000000000000.0_8), &
d020501 =(-181244910846701627703.0_8/3754062500000000000000.0_8), &
d020503 =(-12348710120802100743.0_8/1877031250000000000000.0_8), &
d020504 =(505492958611028165859.0_8/3754062500000000000000.0_8), &
d020505 =(16040554255356295239.0_8/45781250000000000000.0_8), &
d020506 =(356226810890357123127.0_8/3754062500000000000000.0_8), &
d020507 =(282829404314370997287.0_8/3754062500000000000000.0_8), &
d020601 =(-317240276569659297369.0_8/18770312500000000000000.0_8), &
d020603 =(-488761113390649738857.0_8/93851562500000000000000.0_8), &
d020604 =(-501762329025753451149.0_8/37540625000000000000000.0_8), &
d020605 =(2508196356163442567061.0_8/37540625000000000000000.0_8), &
d020606 =(-33034858301307807009.0_8/375406250000000000000.0_8), &
d020607 =(-300650486517799659153.0_8/3754062500000000000000.0_8), &
d020704 =(652696839870332524731.0_8/187703125000000000000000.0_8), &
d020705 =(-623884634825711508837.0_8/3754062500000000000000.0_8), &
d020706 =(291809018392922157759.0_8/3754062500000000000000.0_8), &
d020707 =(159510839817691350279.0_8/1877031250000000000000.0_8), &
d020805 =(2259398187288932945499.0_8/37540625000000000000000.0_8), &
d020806 =(-138155607003388094829.0_8/4692578125000000000000.0_8), &
d020807 =(-1154153331261828186867.0_8/37540625000000000000000.0_8), &
d020905 =(-1995137763512691244167.0_8/375406250000000000000000.0_8), &
d020906 =(482833592914092724359.0_8/187703125000000000000000.0_8), &
d020907 =(1029470577684505795449.0_8/375406250000000000000000.0_8), &
d030101 =(-1910423593055803062501.0_8/16943750000000000000000.0_8), &
d030102 =(498278548626520783581.0_8/1694375000000000000000.0_8), &
d030104 =(117832404972021093369.0_8/1694375000000000000000.0_8), &
d030105 =(-656739334946087764443.0_8/1694375000000000000000.0_8), &
d030106 =(-10679357746376204247.0_8/42359375000000000000.0_8), &
d030107 =(-108158529039623075763.0_8/423593750000000000000.0_8), &
d030201 =(2454680772897965443323.0_8/16943750000000000000000.0_8), &
d030204 =(-297975054556298634831.0_8/1694375000000000000000.0_8), &
d030205 =(34840733714933009949.0_8/16943750000000000000.0_8), &
d030206 =(1792693417158462092517.0_8/1694375000000000000000.0_8), &
d030207 =(893156552640702834867.0_8/847187500000000000000.0_8), &
d030301 =(-854166754863477964053.0_8/84718750000000000000000.0_8), &
d030302 =(-12391036567731380097.0_8/67775000000000000000.0_8), &
d030304 =(-12600797986220544081.0_8/67775000000000000000.0_8), &
d030305 =(-186746229559267472511.0_8/42359375000000000000.0_8), &
d030306 =(-144574293144710309067.0_8/84718750000000000000.0_8), &
d030307 =(-68388393894725681361.0_8/42359375000000000000.0_8), &
d030401 =(-271858870874447628291.0_8/8471875000000000000000.0_8), &
d030402 =(-279103858550339328459.0_8/1694375000000000000000.0_8), &
d030405 =(786569837710970535561.0_8/169437500000000000000.0_8), &
d030406 =(1182033991370105405073.0_8/847187500000000000000.0_8), &
d030407 =(373137687908395871031.0_8/338875000000000000000.0_8), &
d030501 =(1261372794725374974441.0_8/169437500000000000000000.0_8), &
d030502 =(372647704361091231753.0_8/8471875000000000000000.0_8), &
d030504 =(106881676125526978623.0_8/338875000000000000000.0_8), &
d030505 =(-334577950118615991033.0_8/169437500000000000000.0_8), &
d030506 =(-1458806041360826924121.0_8/1694375000000000000000.0_8), &
d030507 =(-709570273566786721371.0_8/1694375000000000000000.0_8), &
d030601 =(88313266813781942253.0_8/33887500000000000000000.0_8), &
d030602 =(1607168324488480097319.0_8/169437500000000000000000.0_8), &
d030604 =(-265232174995477154619.0_8/8471875000000000000000.0_8), &
d030605 =(-436946401706271291081.0_8/847187500000000000000.0_8), &
d030606 =(1258069507171795162953.0_8/1694375000000000000000.0_8), &
d030607 =(299331817327134476019.0_8/847187500000000000000.0_8), &
d030704 =(172508170140646016049.0_8/21179687500000000000000.0_8), &
d030705 =(72304355210959183671.0_8/84718750000000000000.0_8), &
d030706 =(-112331309776528689009.0_8/211796875000000000000.0_8), &
d030707 =(-561237279618205842633.0_8/1694375000000000000000.0_8), &
d030805 =(-246284303508129090897.0_8/847187500000000000000.0_8), &
d030806 =(286150328153140980393.0_8/1694375000000000000000.0_8), &
d030807 =(206418278863117201401.0_8/1694375000000000000000.0_8), &
d030905 =(429705761095573155117.0_8/16943750000000000000000.0_8), &
d030906 =(-310806786266228232639.0_8/21179687500000000000000.0_8), &
d030907 =(-1810603320825905690031.0_8/169437500000000000000000.0_8), &
d040101 =(-608037713880665367429.0_8/3349375000000000000000.0_8), &
d040102 =(448942151996204821731.0_8/3349375000000000000000.0_8), &
d040103 =(-731843359645141250379.0_8/33493750000000000000000.0_8), &
d040105 =(517494470211478775457.0_8/3349375000000000000000.0_8), &
d040106 =(259338954156716742561.0_8/4186718750000000000000.0_8), &
d040107 =(2219288476454558345493.0_8/33493750000000000000000.0_8), &
d040201 =(390630248413213274991.0_8/1674687500000000000000.0_8), &
d040203 =(40859775068590002177.0_8/209335937500000000000.0_8), &
d040205 =(-320670968857568377479.0_8/334937500000000000000.0_8), &
d040206 =(-8345949222454037577.0_8/26166992187500000000.0_8), &
d040207 =(-1042213208874066000189.0_8/3349375000000000000000.0_8), &
d040301 =(-271858870874447628291.0_8/16746875000000000000000.0_8), &
d040302 =(-279103858550339328459.0_8/3349375000000000000000.0_8), &
d040305 =(786569837710970535561.0_8/334937500000000000000.0_8), &
d040306 =(1182033991370105405073.0_8/1674687500000000000000.0_8), &
d040307 =(373137687908395871031.0_8/669875000000000000000.0_8), &
d040401 =(-1730510939516540486409.0_8/33493750000000000000000.0_8), &
d040402 =(-2514687562477268986203.0_8/33493750000000000000000.0_8), &
d040403 =(-622719258651382291857.0_8/3349375000000000000000.0_8), &
d040405 =(-996148883236603487481.0_8/334937500000000000000.0_8), &
d040406 =(-160724295722827197963.0_8/167468750000000000000.0_8), &
d040407 =(-798184738829995630119.0_8/1674687500000000000000.0_8), &
d040501 =(200730935600856557361.0_8/16746875000000000000000.0_8), &
d040502 =(335750480917671703167.0_8/16746875000000000000000.0_8), &
d040503 =(2352490805082173630517.0_8/334937500000000000000000.0_8), &
d040505 =(99271705008091699449.0_8/83734375000000000000.0_8), &
d040506 =(341147116090392535539.0_8/334937500000000000000.0_8), &
d040507 =(825745697417879278263.0_8/3349375000000000000000.0_8), &
d040601 =(43918431439409625861.0_8/10466796875000000000000.0_8), &
d040602 =(144803666183270647203.0_8/33493750000000000000000.0_8), &
d040603 =(1862228546763464577501.0_8/334937500000000000000000.0_8), &
d040605 =(92240505254357022933.0_8/145625000000000000000.0_8), &
d040606 =(-673451844049760660721.0_8/837343750000000000000.0_8), &
d040607 =(-618609961464408342027.0_8/3349375000000000000000.0_8), &
d040705 =(-452067580444567202901.0_8/837343750000000000000.0_8), &
d040706 =(135357678613947454353.0_8/334937500000000000000.0_8), &
d040707 =(484693535638794268071.0_8/3349375000000000000000.0_8), &
d040805 =(136546361557543230651.0_8/837343750000000000000.0_8), &
d040806 =(-196211950838593897311.0_8/1674687500000000000000.0_8), &
d040807 =(-48050482672807852491.0_8/1046679687500000000000.0_8), &
d040905 =(-453092720052490978833.0_8/33493750000000000000000.0_8), &
d040906 =(324115996979071035099.0_8/33493750000000000000000.0_8), &
d040907 =(257953446146839887441.0_8/66987500000000000000000.0_8), &
d050101 =(1410588935334555205509.0_8/24615625000000000000000.0_8), &
d050102 =(-119881726609766657967.0_8/2461562500000000000000.0_8), &
d050103 =(55294733554706945223.0_8/49231250000000000000000.0_8), &
d050104 =(-399788170847073400887.0_8/4923125000000000000000.0_8), &
d050105 =(-1940936268931002346329.0_8/24615625000000000000000.0_8), &
d050106 =(-167619451814797080879.0_8/12307812500000000000000.0_8), &
d050107 =(-186214004609139292959.0_8/12307812500000000000000.0_8), &
d050201 =(-181244910846701627703.0_8/2461562500000000000000.0_8), &
d050203 =(-12348710120802100743.0_8/1230781250000000000000.0_8), &
d050204 =(505492958611028165859.0_8/2461562500000000000000.0_8), &
d050205 =(657662724469608104799.0_8/1230781250000000000000.0_8), &
d050206 =(356226810890357123127.0_8/2461562500000000000000.0_8), &
d050207 =(282829404314370997287.0_8/2461562500000000000000.0_8), &
d050301 =(1261372794725374974441.0_8/246156250000000000000000.0_8), &
d050302 =(372647704361091231753.0_8/12307812500000000000000.0_8), &
d050304 =(106881676125526978623.0_8/492312500000000000000.0_8), &
d050305 =(-334577950118615991033.0_8/246156250000000000000.0_8), &
d050306 =(-1458806041360826924121.0_8/2461562500000000000000.0_8), &
d050307 =(-709570273566786721371.0_8/2461562500000000000000.0_8), &
d050401 =(200730935600856557361.0_8/12307812500000000000000.0_8), &
d050402 =(335750480917671703167.0_8/12307812500000000000000.0_8), &
d050403 =(2352490805082173630517.0_8/246156250000000000000000.0_8), &
d050405 =(99271705008091699449.0_8/61539062500000000000.0_8), &
d050406 =(341147116090392535539.0_8/246156250000000000000.0_8), &
d050407 =(825745697417879278263.0_8/2461562500000000000000.0_8), &
d050501 =(-232838218973940769701.0_8/61539062500000000000000.0_8), &
d050502 =(-224139943105689130929.0_8/30769531250000000000000.0_8), &
d050503 =(-177743434496680594359.0_8/492312500000000000000000.0_8), &
d050504 =(-226646215261412211.0_8/615390625000000000.0_8), &
d050505 =(-479865994921127926953.0_8/615390625000000000000.0_8), &
d050506 =(-56603159898633713853.0_8/24615625000000000000.0_8), &
d050507 =(-12513545302588885017.0_8/49231250000000000000.0_8), &
d050508 =(-329822591275886287131.0_8/49231250000000000000000.0_8), &
d050601 =(-326036899522132327647.0_8/246156250000000000000000.0_8), &
d050602 =(-15466859990123194161.0_8/9846250000000000000000.0_8), &
d050603 =(-703507314469479108471.0_8/2461562500000000000000000.0_8), &
d050604 =(224973525144485388879.0_8/6153906250000000000000.0_8), &
d050605 =(-141191833817194468299.0_8/1230781250000000000000.0_8), &
d050606 =(45509748300015149583.0_8/30769531250000000000.0_8), &
d050607 =(189556314573523456143.0_8/615390625000000000000.0_8), &
d050608 =(183661295637943143567.0_8/6153906250000000000000.0_8), &
d050704 =(-2341180282727167008777.0_8/246156250000000000000000.0_8), &
d050705 =(327366260424611050743.0_8/1230781250000000000000.0_8), &
d050706 =(-468739821065965712199.0_8/2461562500000000000000.0_8), &
d050707 =(-211817059786609416531.0_8/1230781250000000000000.0_8), &
d050708 =(-719733886913829430701.0_8/12307812500000000000000.0_8), &
d050805 =(-2186512419883225793031.0_8/24615625000000000000000.0_8), &
d050806 =(58263866866465575363.0_8/615390625000000000000.0_8), &
d050807 =(-145737487465433959149.0_8/4923125000000000000000.0_8), &
d050808 =(884645182551772574253.0_8/24615625000000000000000.0_8), &
d050905 =(1944584727437707973811.0_8/246156250000000000000000.0_8), &
d050906 =(-2014756060823330869791.0_8/246156250000000000000000.0_8), &
d050907 =(274105362206317914549.0_8/307695312500000000000000.0_8), &
d050908 =(-1491129563794314356511.0_8/2461562500000000000000000.0_8), &
d060101 =(493802139746843285229.0_8/27375625000000000000000.0_8), &
d060102 =(-2585150954069874676389.0_8/273756250000000000000000.0_8), &
d060103 =(2188561823255629155033.0_8/2737562500000000000000000.0_8), &
d060104 =(248023538587423789821.0_8/34219531250000000000000.0_8), &
d060105 =(-28717252642545488919.0_8/2737562500000000000000.0_8), &
d060106 =(22206943772706685203.0_8/1710976562500000000000.0_8), &
d060107 =(285921424643231725821.0_8/13687812500000000000000.0_8), &
d060201 =(-317240276569659297369.0_8/13687812500000000000000.0_8), &
d060203 =(-488761113390649738857.0_8/68439062500000000000000.0_8), &
d060204 =(-501762329025753451149.0_8/27375625000000000000000.0_8), &
d060205 =(2508196356163442567061.0_8/27375625000000000000000.0_8), &
d060206 =(-33034858301307807009.0_8/273756250000000000000.0_8), &
d060207 =(-300650486517799659153.0_8/2737562500000000000000.0_8), &
d060301 =(88313266813781942253.0_8/54751250000000000000000.0_8), &
d060302 =(1607168324488480097319.0_8/273756250000000000000000.0_8), &
d060304 =(-265232174995477154619.0_8/13687812500000000000000.0_8), &
d060305 =(-436946401706271291081.0_8/1368781250000000000000.0_8), &
d060306 =(1258069507171795162953.0_8/2737562500000000000000.0_8), &
d060307 =(299331817327134476019.0_8/1368781250000000000000.0_8), &
d060401 =(43918431439409625861.0_8/8554882812500000000000.0_8), &
d060402 =(144803666183270647203.0_8/27375625000000000000000.0_8), &
d060403 =(1862228546763464577501.0_8/273756250000000000000000.0_8), &
d060405 =(2121531620850211527459.0_8/2737562500000000000000.0_8), &
d060406 =(-673451844049760660721.0_8/684390625000000000000.0_8), &
d060407 =(-618609961464408342027.0_8/2737562500000000000000.0_8), &
d060501 =(-326036899522132327647.0_8/273756250000000000000000.0_8), &
d060502 =(-15466859990123194161.0_8/10950250000000000000000.0_8), &
d060503 =(-703507314469479108471.0_8/2737562500000000000000000.0_8), &
d060504 =(224973525144485388879.0_8/6843906250000000000000.0_8), &
d060505 =(-141191833817194468299.0_8/1368781250000000000000.0_8), &
d060506 =(45509748300015149583.0_8/34219531250000000000.0_8), &
d060507 =(189556314573523456143.0_8/684390625000000000000.0_8), &
d060508 =(183661295637943143567.0_8/6843906250000000000000.0_8), &
d060601 =(-45654042673252926459.0_8/109502500000000000000000.0_8), &
d060602 =(-52114082811395024331.0_8/171097656250000000000000.0_8), &
d060603 =(-278447720397403133727.0_8/1368781250000000000000000.0_8), &
d060604 =(-893252719134261429309.0_8/273756250000000000000000.0_8), &
d060605 =(-786786347214675245133.0_8/1368781250000000000000.0_8), &
d060606 =(-321397759402711123797.0_8/273756250000000000000.0_8), &
d060607 =(-135914189968679886117.0_8/171097656250000000000.0_8), &
d060608 =(-361358073020709029691.0_8/2737562500000000000000.0_8), &
d060609 =(-240.0_8/43801.0_8), &
d060704 =(1161950974112665795851.0_8/1368781250000000000000000.0_8), &
d060705 =(471980171341954347111.0_8/2737562500000000000000.0_8), &
d060706 =(1806733914744940873497.0_8/2737562500000000000000.0_8), &
d060707 =(855674902433815903251.0_8/2737562500000000000000.0_8), &
d060708 =(16915742190621270891.0_8/54751250000000000000.0_8), &
d060709 =(1080.0_8/43801.0_8), &
d060805 =(-905758683757205069349.0_8/27375625000000000000000.0_8), &
d060806 =(-146460866162013185679.0_8/684390625000000000000.0_8), &
d060807 =(18055548120889645587.0_8/54751250000000000000.0_8), &
d060808 =(-496358073020709029691.0_8/2737562500000000000000.0_8), &
d060809 =(-2160.0_8/43801.0_8), &
d060905 =(240542934301893680487.0_8/136878125000000000000000.0_8), &
d060906 =(165725243866011988647.0_8/5475125000000000000000.0_8), &
d060907 =(-78637998874221125361.0_8/2737562500000000000000.0_8), &
d060908 =(-153838704362056856433.0_8/6843906250000000000000.0_8), &
d060909 =(206250000000000000003.0_8/6843906250000000000000.0_8), &
d070104 =(-9559442816580854637.0_8/5000000000000000000000.0_8), &
d070105 =(40681303555291499361.0_8/1000000000000000000000.0_8), &
d070106 =(-1319674981073749167.0_8/100000000000000000000.0_8), &
d070107 =(-25572665181237836763.0_8/1000000000000000000000.0_8), &
d070204 =(24173957032234537953.0_8/5000000000000000000000.0_8), &
d070205 =(-23106838326878204031.0_8/100000000000000000000.0_8), &
d070206 =(10807741421960079917.0_8/100000000000000000000.0_8), &
d070207 =(5907808882136716677.0_8/50000000000000000000.0_8), &
d070304 =(6389191486690593187.0_8/1250000000000000000000.0_8), &
d070305 =(2677939081887377173.0_8/5000000000000000000.0_8), &
d070306 =(-4160418880612173667.0_8/12500000000000000000.0_8), &
d070307 =(-20786565911785401579.0_8/100000000000000000000.0_8), &
d070405 =(-16743243720169155663.0_8/25000000000000000000.0_8), &
d070406 =(5013247356072127939.0_8/10000000000000000000.0_8), &
d070407 =(17951612431066454373.0_8/100000000000000000000.0_8), &
d070504 =(-86710380841746926251.0_8/10000000000000000000000.0_8), &
d070505 =(12124676312022631509.0_8/50000000000000000000.0_8), &
d070506 =(-17360734113554285637.0_8/100000000000000000000.0_8), &
d070507 =(-7845076288392941353.0_8/50000000000000000000.0_8), &
d070508 =(-26656810626438127063.0_8/500000000000000000000.0_8), &
d070604 =(43035221263432066513.0_8/50000000000000000000000.0_8), &
d070605 =(17480747086739049893.0_8/100000000000000000000.0_8), &
d070606 =(66916070916479291611.0_8/100000000000000000000.0_8), &
d070607 =(31691663053104292713.0_8/100000000000000000000.0_8), &
d070608 =(626508970023010033.0_8/2000000000000000000.0_8), &
d070609 =(1.0_8/40.0_8), &
d070704 =(-2239223735771599179.0_8/10000000000000000000000.0_8), &
d070705 =(-6377188927154783369.0_8/50000000000000000000.0_8), &
d070706 =(-5058497419648040823.0_8/5000000000000000000.0_8), &
d070707 =(-48231775430312815001.0_8/100000000000000000000.0_8), &
d070708 =(-3879526910069030099.0_8/4000000000000000000.0_8), &
d070709 =(-1.0_8/8.0_8), &
d070710 =(-1.0_8/180.0_8), &
d070805 =(37841139730330129499.0_8/1000000000000000000000.0_8), &
d070806 =(1873473053209267101.0_8/6250000000000000000.0_8), &
d070807 =(4989358584308526473.0_8/12500000000000000000.0_8), &
d070808 =(876508970023010033.0_8/2000000000000000000.0_8), &
d070809 =(3.0_8/10.0_8), &
d070810 =(1.0_8/40.0_8), &
d070905 =(-3836682690370322953.0_8/1250000000000000000000.0_8), &
d070906 =(-46981462180226839339.0_8/1000000000000000000000.0_8), &
d070907 =(-17163557041460064817.0_8/100000000000000000000.0_8), &
d070908 =(29668637874712374587.0_8/100000000000000000000.0_8), &
d070909 =(-7.0_8/40.0_8), &
d070910 =(-1.0_8/20.0_8), &
d071010 =(11.0_8/360.0_8), &
d071007 =(11.0_8/360.0_8), &
d071008 =(-1.0_8/40.0_8), &
d071009 =(-1.0_8/40.0_8), &
d080105 =(-389913217784196441.0_8/25000000000000000000.0_8), &
d080106 =(12972368314663075799.0_8/2000000000000000000000.0_8), &
d080107 =(91103445540363197401.0_8/10000000000000000000000.0_8), &
d080205 =(83681414344034553537.0_8/1000000000000000000000.0_8), &
d080206 =(-5116874333458818327.0_8/125000000000000000000.0_8), &
d080207 =(-42746419676364006921.0_8/1000000000000000000000.0_8), &
d080305 =(-9121640870671447811.0_8/50000000000000000000.0_8), &
d080306 =(10598160301968184459.0_8/100000000000000000000.0_8), &
d080307 =(7645121439374711163.0_8/100000000000000000000.0_8), &
d080405 =(5057272650279378913.0_8/25000000000000000000.0_8), &
d080406 =(-7267109290318292493.0_8/50000000000000000000.0_8), &
d080407 =(-1779647506400290833.0_8/31250000000000000000.0_8), &
d080505 =(-80981941477156510853.0_8/1000000000000000000000.0_8), &
d080506 =(2157920995054280569.0_8/25000000000000000000.0_8), &
d080507 =(-5397684720941998487.0_8/200000000000000000000.0_8), &
d080508 =(32764636390806391639.0_8/1000000000000000000000.0_8), &
d080605 =(-33546617916933521087.0_8/1000000000000000000000.0_8), &
d080606 =(-5424476524519006877.0_8/25000000000000000000.0_8), &
d080607 =(668724004477394281.0_8/2000000000000000000.0_8), &
d080608 =(-18383632334100334433.0_8/100000000000000000000.0_8), &
d080609 =(-1.0_8/20.0_8), &
d080705 =(37841139730330129499.0_8/1000000000000000000000.0_8), &
d080706 =(1873473053209267101.0_8/6250000000000000000.0_8), &
d080707 =(4989358584308526473.0_8/12500000000000000000.0_8), &
d080708 =(876508970023010033.0_8/2000000000000000000.0_8), &
d080709 =(3.0_8/10.0_8), &
d080710 =(1.0_8/40.0_8), &
d080805 =(-6151644713584022277.0_8/500000000000000000000.0_8), &
d080806 =(-473459011858359333.0_8/4000000000000000000.0_8), &
d080807 =(-47052559491139716671.0_8/50000000000000000000.0_8), &
d080808 =(-11398948689042289109.0_8/20000000000000000000.0_8), &
d080809 =(-19.0_8/20.0_8), &
d080810 =(-1.0_8/8.0_8), &
d080811 =(-1.0_8/180.0_8), &
d080910 =(3.0_8/10.0_8), &
d080911 =(1.0_8/40.0_8), &
d080905 =(5238674302575254013.0_8/5000000000000000000000.0_8), &
d080906 =(5770169731679790849.0_8/250000000000000000000.0_8), &
d080907 =(7466562634437873743.0_8/25000000000000000000.0_8), &
d080908 =(5340113510440635451.0_8/12500000000000000000.0_8), &
d080909 =(17.0_8/40.0_8), &
d081010 =(-7.0_8/40.0_8), &
d081011 =(-1.0_8/20.0_8), &
d081007 =(-1.0_8/20.0_8), &
d081008 =(-7.0_8/40.0_8), &
d081009 =(3.0_8/10.0_8), &
d081110 =(-1.0_8/40.0_8), &
d081111 =(11.0_8/360.0_8), &
d081108 =(11.0_8/360.0_8), &
d081109 =(-1.0_8/40.0_8), &
d090105 =(13848225351007963723.0_8/10000000000000000000000.0_8), &
d090106 =(-55939836966298630593.0_8/100000000000000000000000.0_8), &
d090107 =(-82542416543781006633.0_8/100000000000000000000000.0_8), &
d090205 =(-73893991241210786821.0_8/10000000000000000000000.0_8), &
d090206 =(17882725663484915717.0_8/5000000000000000000000.0_8), &
d090207 =(38128539914240955387.0_8/10000000000000000000000.0_8), &
d090305 =(15915028188724931671.0_8/1000000000000000000000.0_8), &
d090306 =(-11511362454304749357.0_8/1250000000000000000000.0_8), &
d090307 =(-67059382252811321853.0_8/10000000000000000000000.0_8), &
d090405 =(-16781211853795962179.0_8/1000000000000000000000.0_8), &
d090406 =(12004296184410038337.0_8/1000000000000000000000.0_8), &
d090407 =(9553831338771847683.0_8/2000000000000000000000.0_8), &
d090505 =(72021656571766961993.0_8/10000000000000000000000.0_8), &
d090506 =(-74620594845308550733.0_8/10000000000000000000000.0_8), &
d090507 =(10152050452085848687.0_8/12500000000000000000000.0_8), &
d090508 =(-55227020881270902093.0_8/100000000000000000000000.0_8), &
d090605 =(8908997566736802981.0_8/5000000000000000000000.0_8), &
d090606 =(6137971995037481061.0_8/200000000000000000000.0_8), &
d090607 =(-2912518476823004643.0_8/100000000000000000000.0_8), &
d090608 =(-5697729791187290979.0_8/250000000000000000000.0_8), &
d090609 =(7638888888888888889.0_8/250000000000000000000.0_8), &
d090705 =(-3836682690370322953.0_8/1250000000000000000000.0_8), &
d090706 =(-46981462180226839339.0_8/1000000000000000000000.0_8), &
d090707 =(-17163557041460064817.0_8/100000000000000000000.0_8), &
d090708 =(29668637874712374587.0_8/100000000000000000000.0_8), &
d090709 =(-7.0_8/40.0_8), &
d090710 =(-1.0_8/20.0_8), &
d090810 =(3.0_8/10.0_8), &
d090811 =(1.0_8/40.0_8), &
d090805 =(5238674302575254013.0_8/5000000000000000000000.0_8), &
d090806 =(5770169731679790849.0_8/250000000000000000000.0_8), &
d090807 =(7466562634437873743.0_8/25000000000000000000.0_8), &
d090808 =(5340113510440635451.0_8/12500000000000000000.0_8), &
d090809 =(17.0_8/40.0_8), &
d090910 =(-19.0_8/20.0_8), &
d090911 =(-1.0_8/8.0_8), &
d090912 =(-1.0_8/180.0_8), &
d090905 =(-91593624651536418269.0_8/1000000000000000000000000.0_8), &
d090906 =(-5139370221149109977.0_8/1000000000000000000000.0_8), &
d090907 =(-6238616075047110007.0_8/50000000000000000000.0_8), &
d090908 =(-47527613510440635451.0_8/50000000000000000000.0_8), &
d090909 =(-56111111111111111111.0_8/100000000000000000000.0_8), &
d091010 =(17.0_8/40.0_8), &
d091011 =(3.0_8/10.0_8), &
d091012 =(1.0_8/40.0_8), &
d091007 =(1.0_8/40.0_8), &
d091008 =(3.0_8/10.0_8), &
d091009 =(17.0_8/40.0_8), &
d091110 =(3.0_8/10.0_8), &
d091111 =(-7.0_8/40.0_8), &
d091112 =(-1.0_8/20.0_8), &
d091108 =(-1.0_8/20.0_8), &
d091109 =(-7.0_8/40.0_8), &
d091210 =(-1.0_8/40.0_8), &
d091211 =(-1.0_8/40.0_8), &
d091212 =(11.0_8/360.0_8), &
d091209 =(11.0_8/360.0_8), &
di_im3_im3 =(11.0_8/360.0_8), &
di_im3_im2 =(-1.0_8/40.0_8), &
di_im3_im1 =(-1.0_8/40.0_8), &
di_im3_i_0 =(11.0_8/360.0_8), &
di_im2_im3 =(-1.0_8/20.0_8), &
di_im2_im2 =(-7.0_8/40.0_8), &
di_im2_im1 =(3.0_8/10.0_8), &
di_im2_i_0 =(-7.0_8/40.0_8), &
di_im2_ip1 =(-1.0_8/20.0_8), &
di_im1_im3 =(1.0_8/40.0_8), &
di_im1_im2 =(3.0_8/10.0_8), &
di_im1_im1 =(17.0_8/40.0_8), &
di_im1_i_0 =(17.0_8/40.0_8), &
di_im1_ip1 =(3.0_8/10.0_8), &
di_im1_ip2 =(1.0_8/40.0_8), &
di_i_0_im3 =(-1.0_8/180.0_8), &
di_i_0_im2 =(-1.0_8/8.0_8), &
di_i_0_im1 =(-19.0_8/20.0_8), &
di_i_0_i_0 =(-101.0_8/180.0_8), &
di_i_0_ip1 =(-19.0_8/20.0_8), &
di_i_0_ip2 =(-1.0_8/8.0_8), &
di_i_0_ip3 =(-1.0_8/180.0_8)

type, extends(laplace_operator_t) :: laplace_Ah_sbp63_narrow_t
    type(grid_field_t)             :: d2f_x, d2f_y, d1f_x, d1f_y, d2f_xy, d2f_yx
    type(sbp_operator_t)           :: sbp_d1_op
    class(halo_t), allocatable     :: edge_sync
    class(exchange_t), allocatable :: exchange
contains
    procedure :: calc_laplace
end type laplace_Ah_sbp63_narrow_t

contains

    subroutine calc_laplace(this, f1, f, domain)

        use vec_math_mod,   only : divide_by_J_self

        class(laplace_Ah_sbp63_narrow_t), intent(inout) :: this
        type(domain_t),                   intent(in)    :: domain
        type(grid_field_t),               intent(inout) :: f
        !output:
        type(grid_field_t),               intent(inout) :: f1

        integer(kind=4) :: t

        call this%exchange%do(f, domain%parcomm)
        do t = domain%partition%ts, domain%partition%te

            call calc_tile_d1x_d1y(this%d1f_x%tile(t), this%d1f_y%tile(t), f%tile(t), this%sbp_d1_op, domain%mesh_xy%tile(t))

        end do

        call this%exchange%do(this%d1f_x, domain%parcomm)
        call this%exchange%do(this%d1f_y, domain%parcomm)

        do t = domain%partition%ts, domain%partition%te

            call calc_laplace_tile(f1%tile(t), this%d2f_x%tile(t), this%d2f_y%tile(t), &
                                          this%d2f_xy%tile(t), this%d2f_yx%tile(t), this%d1f_x%tile(t), this%d1f_y%tile(t), &
                                    f%tile(t), &
                                    this%sbp_d1_op, domain%mesh_xy%tile(t), domain%mesh_xy%scale)

        end do

        call divide_by_J_self(f1, domain%mesh_xy)

        call this%edge_sync%get_halo_scalar(f1,domain,0)

    end subroutine calc_laplace

    subroutine calc_tile_d1x_d1y(d1f_x, d1f_y, f, sbp_d1_op, mesh_xy)

        use grid_field_mod, only : grid_field_t, tile_field_t
        use mesh_mod,       only : tile_mesh_t
        use tile_mod,       only : tile_t

        !result
        type(tile_field_t), intent(inout) :: d1f_x, d1f_y
        !input
        type(tile_field_t),   intent(in) :: f
        type(sbp_operator_t), intent(in) :: sbp_d1_op
        type(tile_mesh_t),    intent(in) :: mesh_xy

        integer(kind=4) :: i, j, k

        type(tile_t) :: work

        work = tile_t(is = mesh_xy%is, ie = mesh_xy%ie, &
                      js = mesh_xy%js, je = mesh_xy%je, &
                      ks = mesh_xy%ks, ke = mesh_xy%ke)

        call sbp_d1_op%apply(d1f_x, work, mesh_xy%nx, "x", f)
        call sbp_d1_op%apply(d1f_y, work, mesh_xy%ny, "y", f)

        do k = mesh_xy%ks, mesh_xy%ke
            do j = mesh_xy%js, mesh_xy%je
                do i = mesh_xy%is, mesh_xy%ie
                    d1f_x%p(i,j,k) = d1f_x%p(i,j,k)*mesh_xy%J(i,j,k)*mesh_xy%Qi(2,i,j,k)
                    d1f_y%p(i,j,k) = d1f_y%p(i,j,k)*mesh_xy%J(i,j,k)*mesh_xy%Qi(2,i,j,k)
                end do
            end do
        end do

    end subroutine calc_tile_d1x_d1y
    subroutine calc_laplace_tile(fout,d2f_x, d2f_y, d2f_xy, d2f_yx, d1f_x, d1f_y, f, sbp_d1_op, mesh_xy, scale)

        use grid_field_mod, only : grid_field_t, tile_field_t
        use mesh_mod,       only : tile_mesh_t
        use tile_mod,       only : tile_t

        !result
        type(tile_field_t), intent(inout) :: fout, d2f_x, d2f_y, d2f_xy, d2f_yx, d1f_x, d1f_y
        !input
        type(tile_field_t),   intent(in) :: f
        type(sbp_operator_t), intent(in) :: sbp_d1_op
        type(tile_mesh_t),    intent(in) :: mesh_xy
        real(kind=8),         intent(in) :: scale

        integer(kind=4) :: i, j, k
        real(kind=8)    :: penalty, bmm, bm, bc, bp, bpp, cm, cc, cp, cmm, cpp, cmmm, cppp, bmmm, bppp
        real(kind=8) :: b1, b2, b3, b4, b5, b6, b7, b8, b9, b10, b11, b12
        real(kind=8) :: m11, m12, m13, m14, m15, m16, m17, m18, m19,                  &
                        m21, m22, m23, m24, m25, m26, m27, m28, m29,                  &
                        m31, m32, m33, m34, m35, m36, m37, m38, m39,                  &
                        m41, m42, m43, m44, m45, m46, m47, m48, m49,                  &
                        m51, m52, m53, m54, m55, m56, m57, m58, m59,                  &
                        m61, m62, m63, m64, m65, m66, m67, m68, m69,                  &
                        m71, m72, m73, m74, m75, m76, m77, m78, m79, m710,            &
                        m81, m82, m83, m84, m85, m86, m87, m88, m89, m810, m811,      &
                        m91, m92, m93, m94, m95, m96, m97, m98, m99, m910, m911, m912
        real(kind=8) :: h11, h22, h33, h44, h55, h66
        type(tile_t) :: work

        work = tile_t(is = mesh_xy%is, ie = mesh_xy%ie, &
                      js = mesh_xy%js, je = mesh_xy%je, &
                      ks = mesh_xy%ks, ke = mesh_xy%ke)

        do k = mesh_xy%ks, mesh_xy%ke
          if (mesh_xy%is==1) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)

                  m11 = d010101*b1 + d010102*b2 + d010103*b3 + d010104*b4 + d010105*b5 + d010106*b6 + d010107*b7
                  m12 = d010201*b1 + d010203*b3 + d010204*b4 + d010205*b5 + d010206*b6 + d010207*b7
                  m13 = d010301*b1 + d010302*b2 + d010304*b4 + d010305*b5 + d010306*b6 + d010307*b7
                  m14 = d010401*b1 + d010402*b2 + d010403*b3 + d010405*b5 + d010406*b6 + d010407*b7
                  m15 = d010501*b1 + d010502*b2 + d010503*b3 + d010504*b4 + d010505*b5 + d010506*b6 + d010507*b7
                  m16 = d010601*b1 + d010602*b2 + d010603*b3 + d010604*b4 + d010605*b5 + d010606*b6 + d010607*b7
                  m17 = d010704*b4 + d010705*b5 + d010706*b6 + d010707*b7
                  m18 = d010805*b5 + d010806*b6 + d010807*b7
                  m19 = d010905*b5 + d010906*b6 + d010907*b7

                  ! print*, 13649.0_8/43200*d010101, 13649.0_8/43200*d010201, 13649.0_8/43200*d010301, 13649.0_8/43200*d010401, 13649.0_8/43200*d010501
                  ! read(*,*)
                  d2f_x%p(1,j,k) = 1.0_8*(m11*f%p(1,j,k)+m12*f%p(2,j,k)+m13*f%p(3,j,k) + &
                                           m14*f%p(4,j,k)+m15*f%p(5,j,k)+m16*f%p(6,j,k) + &
                                           m17*f%p(7,j,k)+m18*f%p(8,j,k)+m19*f%p(9,j,k))
                  ! print*, j, 1, d2f_x%p(1,j,k)
                  ! read(*,*)
              end do
          end if
          if (mesh_xy%is<=2 .and. mesh_xy%ie>=2) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)

                  m21 = d020101*b1 + d020103*b3 + d020104*b4 + d020105*b5 + d020106*b6 + d020107*b7
                  m22 = d020201*b1 + d020203*b3 + d020204*b4 + d020205*b5 + d020206*b6 + d020207*b7
                  m23 = d020301*b1 + d020304*b4 + d020305*b5 + d020306*b6 + d020307*b7
                  m24 = d020401*b1 + d020403*b3 + d020405*b5 + d020406*b6 + d020407*b7
                  m25 = d020501*b1 + d020503*b3 + d020504*b4 + d020505*b5 + d020506*b6 + d020507*b7
                  m26 = d020601*b1 + d020603*b3 + d020604*b4 + d020605*b5 + d020606*b6 + d020607*b7
                  m27 = d020704*b4 + d020705*b5 + d020706*b6 + d020707*b7
                  m28 = d020805*b5 + d020806*b6 + d020807*b7
                  m29 = d020905*b5 + d020906*b6 + d020907*b7

                  d2f_x%p(2,j,k) = 1.0_8*(m21*f%p(1,j,k)+m22*f%p(2,j,k)+m23*f%p(3,j,k) + &
                                           m24*f%p(4,j,k)+m25*f%p(5,j,k)+m26*f%p(6,j,k) + &
                                           m27*f%p(7,j,k)+m28*f%p(8,j,k)+m29*f%p(9,j,k))
              end do
          end if
          if (mesh_xy%is<=3 .and. mesh_xy%ie>=3) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)

                  m31 = d030101*b1 + d030102*b2 + d030104*b4 + d030105*b5 + d030106*b6 + d030107*b7
                  m32 = d030201*b1 + d030204*b4 + d030205*b5 + d030206*b6 + d030207*b7
                  m33 = d030301*b1 + d030302*b2 + d030304*b4 + d030305*b5 + d030306*b6 + d030307*b7
                  m34 = d030401*b1 + d030402*b2 + d030405*b5 + d030406*b6 + d030407*b7
                  m35 = d030501*b1 + d030502*b2 + d030504*b4 + d030505*b5 + d030506*b6 + d030507*b7
                  m36 = d030601*b1 + d030602*b2 + d030604*b4 + d030605*b5 + d030606*b6 + d030607*b7
                  m37 = d030704*b4 + d030705*b5 + d030706*b6 + d030707*b7
                  m38 = d030805*b5 + d030806*b6 + d030807*b7
                  m39 = d030905*b5 + d030906*b6 + d030907*b7

                  d2f_x%p(3,j,k) = 1.0_8*(m31*f%p(1,j,k)+m32*f%p(2,j,k)+m33*f%p(3,j,k) + &
                                           m34*f%p(4,j,k)+m35*f%p(5,j,k)+m36*f%p(6,j,k) + &
                                           m37*f%p(7,j,k)+m38*f%p(8,j,k)+m39*f%p(9,j,k))
              end do
          end if
          if (mesh_xy%is<=4 .and. mesh_xy%ie>=4) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)

                  m41 = d040101*b1 + d040102*b2 + d040103*b3 + d040105*b5 + d040106*b6 + d040107*b7
                  m42 = d040201*b1 + d040203*b3 + d040205*b5 + d040206*b6 + d040207*b7
                  m43 = d040301*b1 + d040302*b2 + d040305*b5 + d040306*b6 + d040307*b7
                  m44 = d040401*b1 + d040402*b2 + d040403*b3 + d040405*b5 + d040406*b6 + d040407*b7
                  m45 = d040501*b1 + d040502*b2 + d040503*b3 + d040505*b5 + d040506*b6 + d040507*b7
                  m46 = d040601*b1 + d040602*b2 + d040603*b3 + d040605*b5 + d040606*b6 + d040607*b7
                  m47 = d040705*b5 + d040706*b6 + d040707*b7
                  m48 = d040805*b5 + d040806*b6 + d040807*b7
                  m49 = d040905*b5 + d040906*b6 + d040907*b7

                  d2f_x%p(4,j,k) = 1.0_8*(m41*f%p(1,j,k)+m42*f%p(2,j,k)+m43*f%p(3,j,k) + &
                                           m44*f%p(4,j,k)+m45*f%p(5,j,k)+m46*f%p(6,j,k) + &
                                           m47*f%p(7,j,k)+m48*f%p(8,j,k)+m49*f%p(9,j,k))
              end do
          end if
          if (mesh_xy%is<=5 .and. mesh_xy%ie>=5) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)
                  b8  = mesh_xy%Qi(1,8,j,k)*mesh_xy%J(8,j,k)

                  m51 = d050101*b1 + d050102*b2 + d050103*b3 + d050104*b4 + d050105*b5 + d050106*b6 + d050107*b7
                  m52 = d050201*b1 + d050203*b3 + d050204*b4 + d050205*b5 + d050206*b6 + d050207*b7
                  m53 = d050301*b1 + d050302*b2 + d050304*b4 + d050305*b5 + d050306*b6 + d050307*b7
                  m54 = d050401*b1 + d050402*b2 + d050403*b3 + d050405*b5 + d050406*b6 + d050407*b7
                  m55 = d050501*b1 + d050502*b2 + d050503*b3 + d050504*b4 + d050505*b5 + d050506*b6 + d050507*b7 + d050508*b8
                  m56 = d050601*b1 + d050602*b2 + d050603*b3 + d050604*b4 + d050605*b5 + d050606*b6 + d050607*b7 + d050608*b8
                  m57 = d050704*b4 + d050705*b5 + d050706*b6 + d050707*b7 + d050708*b8
                  m58 = d050805*b5 + d050806*b6 + d050807*b7 + d050808*b8
                  m59 = d050905*b5 + d050906*b6 + d050907*b7 + d050908*b8

                  d2f_x%p(5,j,k) = 1.0_8*(m51*f%p(1,j,k)+m52*f%p(2,j,k)+m53*f%p(3,j,k) + &
                                           m54*f%p(4,j,k)+m55*f%p(5,j,k)+m56*f%p(6,j,k) + &
                                           m57*f%p(7,j,k)+m58*f%p(8,j,k)+m59*f%p(9,j,k))
              end do
          end if
          if (mesh_xy%is<=6 .and. mesh_xy%ie>=6) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,1,j,k)*mesh_xy%J(1,j,k)
                  b2  = mesh_xy%Qi(1,2,j,k)*mesh_xy%J(2,j,k)
                  b3  = mesh_xy%Qi(1,3,j,k)*mesh_xy%J(3,j,k)
                  b4  = mesh_xy%Qi(1,4,j,k)*mesh_xy%J(4,j,k)
                  b5  = mesh_xy%Qi(1,5,j,k)*mesh_xy%J(5,j,k)
                  b6  = mesh_xy%Qi(1,6,j,k)*mesh_xy%J(6,j,k)
                  b7  = mesh_xy%Qi(1,7,j,k)*mesh_xy%J(7,j,k)
                  b8  = mesh_xy%Qi(1,8,j,k)*mesh_xy%J(8,j,k)
                  b9  = mesh_xy%Qi(1,9,j,k)*mesh_xy%J(9,j,k)

                  m61 = d060101*b1 + d060102*b2 + d060103*b3 + d060104*b4 + d060105*b5 + d060106*b6 + d060107*b7
                  m62 = d060201*b1 + d060203*b3 + d060204*b4 + d060205*b5 + d060206*b6 + d060207*b7
                  m63 = d060301*b1 + d060302*b2 + d060304*b4 + d060305*b5 + d060306*b6 + d060307*b7
                  m64 = d060401*b1 + d060402*b2 + d060403*b3 + d060405*b5 + d060406*b6 + d060407*b7
                  m65 = d060501*b1 + d060502*b2 + d060503*b3 + d060504*b4 + d060505*b5 + d060506*b6 + d060507*b7 + d060508*b8
                  m66 = d060601*b1 + d060602*b2 + d060603*b3 + d060604*b4 + d060605*b5 + d060606*b6 + d060607*b7 + d060608*b8 + d060609*b9
                  m67 = d060704*b4 + d060705*b5 + d060706*b6 + d060707*b7 + d060708*b8 + d060709*b9
                  m68 = d060805*b5 + d060806*b6 + d060807*b7 + d060808*b8 + d060809*b9
                  m69 = d060905*b5 + d060906*b6 + d060907*b7 + d060908*b8 + d060909*b9

                  d2f_x%p(6,j,k) = 1.0_8*(m61*f%p(1,j,k)+m62*f%p(2,j,k)+m63*f%p(3,j,k) + &
                                           m64*f%p(4,j,k)+m65*f%p(5,j,k)+m66*f%p(6,j,k) + &
                                           m67*f%p(7,j,k)+m68*f%p(8,j,k)+m69*f%p(9,j,k) )
              end do
          end if
          if (mesh_xy%is<=7 .and. mesh_xy%ie>=7) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1, 1,j,k)*mesh_xy%J( 1,j,k)
                  b2  = mesh_xy%Qi(1, 2,j,k)*mesh_xy%J( 2,j,k)
                  b3  = mesh_xy%Qi(1, 3,j,k)*mesh_xy%J( 3,j,k)
                  b4  = mesh_xy%Qi(1, 4,j,k)*mesh_xy%J( 4,j,k)
                  b5  = mesh_xy%Qi(1, 5,j,k)*mesh_xy%J( 5,j,k)
                  b6  = mesh_xy%Qi(1, 6,j,k)*mesh_xy%J( 6,j,k)
                  b7  = mesh_xy%Qi(1, 7,j,k)*mesh_xy%J( 7,j,k)
                  b8  = mesh_xy%Qi(1, 8,j,k)*mesh_xy%J( 8,j,k)
                  b9  = mesh_xy%Qi(1, 9,j,k)*mesh_xy%J( 9,j,k)
                  b10 = mesh_xy%Qi(1,10,j,k)*mesh_xy%J(10,j,k)

                  m71  = d070104*b4 + d070105*b5 + d070106*b6 + d070107*b7
                  m72  = d070204*b4 + d070205*b5 + d070206*b6 + d070207*b7
                  m73  = d070304*b4 + d070305*b5 + d070306*b6 + d070307*b7
                  m74  = d070405*b5 + d070406*b6 + d070407*b7
                  m75  = d070504*b4 + d070505*b5 + d070506*b6 + d070507*b7 + d070508*b8
                  m76  = d070604*b4 + d070605*b5 + d070606*b6 + d070607*b7 + d070608*b8 + d070609*b9
                  m77  = d070704*b4 + d070705*b5 + d070706*b6 + d070707*b7 + d070708*b8 + d070709*b9 + d070710*b10
                  m78  = d070805*b5 + d070806*b6 + d070807*b7 + d070808*b8 + d070809*b9 + d070810*b10
                  m79  = d070905*b5 + d070906*b6 + d070907*b7 + d070908*b8 + d070909*b9 + d070910*b10
                  m710 = d071010*b10 + d071007*b7 + d071008*b8 + d071009*b9

                  d2f_x%p(7,j,k) = 1.0_8*( m71*f%p( 1,j,k)+m72*f%p(2,j,k)+m73*f%p(3,j,k) + &
                                            m74*f%p( 4,j,k)+m75*f%p(5,j,k)+m76*f%p(6,j,k) + &
                                            m77*f%p( 7,j,k)+m78*f%p(8,j,k)+m79*f%p(9,j,k) + &
                                           m710*f%p(10,j,k) )
              end do
          end if
          if (mesh_xy%is<=8 .and. mesh_xy%ie>=8) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1, 1,j,k)*mesh_xy%J( 1,j,k)
                  b2  = mesh_xy%Qi(1, 2,j,k)*mesh_xy%J( 2,j,k)
                  b3  = mesh_xy%Qi(1, 3,j,k)*mesh_xy%J( 3,j,k)
                  b4  = mesh_xy%Qi(1, 4,j,k)*mesh_xy%J( 4,j,k)
                  b5  = mesh_xy%Qi(1, 5,j,k)*mesh_xy%J( 5,j,k)
                  b6  = mesh_xy%Qi(1, 6,j,k)*mesh_xy%J( 6,j,k)
                  b7  = mesh_xy%Qi(1, 7,j,k)*mesh_xy%J( 7,j,k)
                  b8  = mesh_xy%Qi(1, 8,j,k)*mesh_xy%J( 8,j,k)
                  b9  = mesh_xy%Qi(1, 9,j,k)*mesh_xy%J( 9,j,k)
                  b10 = mesh_xy%Qi(1,10,j,k)*mesh_xy%J(10,j,k)
                  b11 = mesh_xy%Qi(1,11,j,k)*mesh_xy%J(11,j,k)

                  m81  = d080105*b5 + d080106*b6 + d080107*b7
                  m82  = d080205*b5 + d080206*b6 + d080207*b7
                  m83  = d080305*b5 + d080306*b6 + d080307*b7
                  m84  = d080405*b5 + d080406*b6 + d080407*b7
                  m85  = d080505*b5 + d080506*b6 + d080507*b7 + d080508*b8
                  m86  = d080605*b5 + d080606*b6 + d080607*b7 + d080608*b8 + d080609*b9
                  m87  = d080705*b5 + d080706*b6 + d080707*b7 + d080708*b8 + d080709*b9 + d080710*b10
                  m88  = d080805*b5 + d080806*b6 + d080807*b7 + d080808*b8 + d080809*b9 + d080810*b10 + d080811*b11
                  m89  = d080910*b10 + d080911*b11 + d080905*b5 + d080906*b6 + d080907*b7 + d080908*b8 + d080909*b9
                  m810 = d081010*b10 + d081011*b11 + d081007*b7 + d081008*b8 + d081009*b9
                  m811 = d081110*b10 + d081111*b11 + d081108*b8 + d081109*b9

                  d2f_x%p(8,j,k) = 1.0_8*( m81*f%p( 1,j,k)+ m82*f%p( 2,j,k)+m83*f%p(3,j,k) + &
                                            m84*f%p( 4,j,k)+ m85*f%p( 5,j,k)+m86*f%p(6,j,k) + &
                                            m87*f%p( 7,j,k)+ m88*f%p( 8,j,k)+m89*f%p(9,j,k) + &
                                           m810*f%p(10,j,k)+m811*f%p(11,j,k))
              end do
          end if
          if (mesh_xy%is<=9 .and. mesh_xy%ie>=9) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1, 1,j,k)*mesh_xy%J( 1,j,k)
                  b2  = mesh_xy%Qi(1, 2,j,k)*mesh_xy%J( 2,j,k)
                  b3  = mesh_xy%Qi(1, 3,j,k)*mesh_xy%J( 3,j,k)
                  b4  = mesh_xy%Qi(1, 4,j,k)*mesh_xy%J( 4,j,k)
                  b5  = mesh_xy%Qi(1, 5,j,k)*mesh_xy%J( 5,j,k)
                  b6  = mesh_xy%Qi(1, 6,j,k)*mesh_xy%J( 6,j,k)
                  b7  = mesh_xy%Qi(1, 7,j,k)*mesh_xy%J( 7,j,k)
                  b8  = mesh_xy%Qi(1, 8,j,k)*mesh_xy%J( 8,j,k)
                  b9  = mesh_xy%Qi(1, 9,j,k)*mesh_xy%J( 9,j,k)
                  b10 = mesh_xy%Qi(1,10,j,k)*mesh_xy%J(10,j,k)
                  b11 = mesh_xy%Qi(1,11,j,k)*mesh_xy%J(11,j,k)
                  b12 = mesh_xy%Qi(1,12,j,k)*mesh_xy%J(12,j,k)

                  m91  = d090105*b5 + d090106*b6 + d090107*b7
                  m92  = d090205*b5 + d090206*b6 + d090207*b7
                  m93  = d090305*b5 + d090306*b6 + d090307*b7
                  m94  = d090405*b5 + d090406*b6 + d090407*b7
                  m95  = d090505*b5 + d090506*b6 + d090507*b7 + d090508*b8
                  m96  = d090605*b5 + d090606*b6 + d090607*b7 + d090608*b8 + d090609*b9
                  m97  = d090705*b5 + d090706*b6 + d090707*b7 + d090708*b8 + d090709*b9 + d090710*b10
                  m98  = d090810*b10 + d090811*b11 + d090805*b5 + d090806*b6 + d090807*b7 + d090808*b8 + d090809*b9
                  m99  = d090910*b10 + d090911*b11 + d090912*b12 + d090905*b5 + d090906*b6 + d090907*b7 + d090908*b8 + d090909*b9
                  m910 = d091010*b10 + d091011*b11 + d091012*b12 + d091007*b7 + d091008*b8 + d091009*b9
                  m911 = d091110*b10 + d091111*b11 + d091112*b12 + d091108*b8 + d091109*b9
                  m912 = d091210*b10 + d091211*b11 + d091212*b12 + d091209*b9

                  d2f_x%p(9,j,k) = 1.0_8*( m91*f%p( 1,j,k)+ m92*f%p( 2,j,k)+ m93*f%p( 3,j,k) + &
                                            m94*f%p( 4,j,k)+ m95*f%p( 5,j,k)+ m96*f%p( 6,j,k) + &
                                            m97*f%p( 7,j,k)+ m98*f%p( 8,j,k)+ m99*f%p( 9,j,k) + &
                                           m910*f%p(10,j,k)+m911*f%p(11,j,k)+m912*f%p(12,j,k))
              end do
          end if

          do j = mesh_xy%js, mesh_xy%je
              do i = max(mesh_xy%is,10), min(mesh_xy%ie,mesh_xy%nx-9)

                  bmmm = mesh_xy%Qi(1,i-3,j,k)*mesh_xy%J(i-3,j,k)
                  bmm  = mesh_xy%Qi(1,i-2,j,k)*mesh_xy%J(i-2,j,k)
                  bm   = mesh_xy%Qi(1,i-1,j,k)*mesh_xy%J(i-1,j,k)
                  bc   = mesh_xy%Qi(1,i  ,j,k)*mesh_xy%J(i  ,j,k)
                  bp   = mesh_xy%Qi(1,i+1,j,k)*mesh_xy%J(i+1,j,k)
                  bpp  = mesh_xy%Qi(1,i+2,j,k)*mesh_xy%J(i+2,j,k)
                  bppp = mesh_xy%Qi(1,i+3,j,k)*mesh_xy%J(i+3,j,k)

                  cmmm = di_im3_im3*bmmm + di_im3_im2*bmm + di_im3_im1*bm + di_im3_i_0*bc
                  cmm  = di_im2_im3*bmmm + di_im2_im2*bmm + di_im2_im1*bm + di_im2_i_0*bc + di_im2_ip1*bp
                  cm   = di_im1_im3*bmmm + di_im1_im2*bmm + di_im1_im1*bm + di_im1_i_0*bc + di_im1_ip1*bp + di_im1_ip2*bpp
                  cc   = di_i_0_im3*bmmm + di_i_0_im2*bmm + di_i_0_im1*bm + di_i_0_i_0*bc + di_i_0_ip1*bp + di_i_0_ip2*bpp + di_i_0_ip3*bppp
                  cp   = di_im1_im3*bppp + di_im1_im2*bpp + di_im1_im1*bp + di_im1_i_0*bc + di_im1_ip1*bm + di_im1_ip2*bmm
                  cpp  = di_im2_im3*bppp + di_im2_im2*bpp + di_im2_im1*bp + di_im2_i_0*bc + di_im2_ip1*bm
                  cppp = di_im3_im3*bppp + di_im3_im2*bpp + di_im3_im1*bp + di_im3_i_0*bc

                  d2f_x%p(i,j,k) = (cmmm*f%p(i-3,j,k)+cmm*f%p(i-2,j,k)+cm*f%p(i-1,j,k)+cc*f%p(i,j,k) + &
                                      cp*f%p(i+1,j,k)+cpp*f%p(i+2,j,k)+cppp*f%p(i+3,j,k))

              end do
          end do
          if (mesh_xy%ie==mesh_xy%nx) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx  ,j,k)*mesh_xy%J(mesh_xy%nx  ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1,j,k)*mesh_xy%J(mesh_xy%nx-1,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2,j,k)*mesh_xy%J(mesh_xy%nx-2,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3,j,k)*mesh_xy%J(mesh_xy%nx-3,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4,j,k)*mesh_xy%J(mesh_xy%nx-4,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5,j,k)*mesh_xy%J(mesh_xy%nx-5,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6,j,k)*mesh_xy%J(mesh_xy%nx-6,j,k)

                  m11 = d010101*b1 + d010102*b2 + d010103*b3 + d010104*b4 + d010105*b5 + d010106*b6 + d010107*b7
                  m12 = d010201*b1 + d010203*b3 + d010204*b4 + d010205*b5 + d010206*b6 + d010207*b7
                  m13 = d010301*b1 + d010302*b2 + d010304*b4 + d010305*b5 + d010306*b6 + d010307*b7
                  m14 = d010401*b1 + d010402*b2 + d010403*b3 + d010405*b5 + d010406*b6 + d010407*b7
                  m15 = d010501*b1 + d010502*b2 + d010503*b3 + d010504*b4 + d010505*b5 + d010506*b6 + d010507*b7
                  m16 = d010601*b1 + d010602*b2 + d010603*b3 + d010604*b4 + d010605*b5 + d010606*b6 + d010607*b7
                  m17 = d010704*b4 + d010705*b5 + d010706*b6 + d010707*b7
                  m18 = d010805*b5 + d010806*b6 + d010807*b7
                  m19 = d010905*b5 + d010906*b6 + d010907*b7

                  d2f_x%p(mesh_xy%nx,j,k) = 1.0_8*(m11*f%p(mesh_xy%nx  ,j,k)+m12*f%p(mesh_xy%nx-1,j,k)+m13*f%p(mesh_xy%nx-2,j,k) + &
                                                   m14*f%p(mesh_xy%nx-3,j,k)+m15*f%p(mesh_xy%nx-4,j,k)+m16*f%p(mesh_xy%nx-5,j,k) + &
                                                   m17*f%p(mesh_xy%nx-6,j,k)+m18*f%p(mesh_xy%nx-7,j,k)+m19*f%p(mesh_xy%nx-8,j,k))
                  ! print*, j, mesh_xy%nx, d2f_x%p(mesh_xy%nx,j,k)
                  ! read(*,*)
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-1 .and. mesh_xy%ie>=mesh_xy%nx-1) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx  ,j,k)*mesh_xy%J(mesh_xy%nx  ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1,j,k)*mesh_xy%J(mesh_xy%nx-1,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2,j,k)*mesh_xy%J(mesh_xy%nx-2,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3,j,k)*mesh_xy%J(mesh_xy%nx-3,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4,j,k)*mesh_xy%J(mesh_xy%nx-4,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5,j,k)*mesh_xy%J(mesh_xy%nx-5,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6,j,k)*mesh_xy%J(mesh_xy%nx-6,j,k)

                  m21 = d020101*b1 + d020103*b3 + d020104*b4 + d020105*b5 + d020106*b6 + d020107*b7
                  m22 = d020201*b1 + d020203*b3 + d020204*b4 + d020205*b5 + d020206*b6 + d020207*b7
                  m23 = d020301*b1 + d020304*b4 + d020305*b5 + d020306*b6 + d020307*b7
                  m24 = d020401*b1 + d020403*b3 + d020405*b5 + d020406*b6 + d020407*b7
                  m25 = d020501*b1 + d020503*b3 + d020504*b4 + d020505*b5 + d020506*b6 + d020507*b7
                  m26 = d020601*b1 + d020603*b3 + d020604*b4 + d020605*b5 + d020606*b6 + d020607*b7
                  m27 = d020704*b4 + d020705*b5 + d020706*b6 + d020707*b7
                  m28 = d020805*b5 + d020806*b6 + d020807*b7
                  m29 = d020905*b5 + d020906*b6 + d020907*b7

                  d2f_x%p(mesh_xy%nx-1,j,k) = 1.0_8*(m21*f%p(mesh_xy%nx  ,j,k)+m22*f%p(mesh_xy%nx-1,j,k)+m23*f%p(mesh_xy%nx-2,j,k) + &
                                                      m24*f%p(mesh_xy%nx-3,j,k)+m25*f%p(mesh_xy%nx-4,j,k)+m26*f%p(mesh_xy%nx-5,j,k) + &
                                                      m27*f%p(mesh_xy%nx-6,j,k)+m28*f%p(mesh_xy%nx-7,j,k)+m29*f%p(mesh_xy%nx-8,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-2 .and. mesh_xy%ie>=mesh_xy%nx-2) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx  ,j,k)*mesh_xy%J(mesh_xy%nx  ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1,j,k)*mesh_xy%J(mesh_xy%nx-1,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2,j,k)*mesh_xy%J(mesh_xy%nx-2,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3,j,k)*mesh_xy%J(mesh_xy%nx-3,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4,j,k)*mesh_xy%J(mesh_xy%nx-4,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5,j,k)*mesh_xy%J(mesh_xy%nx-5,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6,j,k)*mesh_xy%J(mesh_xy%nx-6,j,k)

                  m31 = d030101*b1 + d030102*b2 + d030104*b4 + d030105*b5 + d030106*b6 + d030107*b7
                  m32 = d030201*b1 + d030204*b4 + d030205*b5 + d030206*b6 + d030207*b7
                  m33 = d030301*b1 + d030302*b2 + d030304*b4 + d030305*b5 + d030306*b6 + d030307*b7
                  m34 = d030401*b1 + d030402*b2 + d030405*b5 + d030406*b6 + d030407*b7
                  m35 = d030501*b1 + d030502*b2 + d030504*b4 + d030505*b5 + d030506*b6 + d030507*b7
                  m36 = d030601*b1 + d030602*b2 + d030604*b4 + d030605*b5 + d030606*b6 + d030607*b7
                  m37 = d030704*b4 + d030705*b5 + d030706*b6 + d030707*b7
                  m38 = d030805*b5 + d030806*b6 + d030807*b7
                  m39 = d030905*b5 + d030906*b6 + d030907*b7

                  d2f_x%p(mesh_xy%nx-2,j,k) = 1.0_8*(m31*f%p(mesh_xy%nx  ,j,k)+m32*f%p(mesh_xy%nx-1,j,k)+m33*f%p(mesh_xy%nx-2,j,k) + &
                                                      m34*f%p(mesh_xy%nx-3,j,k)+m35*f%p(mesh_xy%nx-4,j,k)+m36*f%p(mesh_xy%nx-5,j,k) + &
                                                      m37*f%p(mesh_xy%nx-6,j,k)+m38*f%p(mesh_xy%nx-7,j,k)+m39*f%p(mesh_xy%nx-8,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-3 .and. mesh_xy%ie>=mesh_xy%nx-3) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx  ,j,k)*mesh_xy%J(mesh_xy%nx  ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1,j,k)*mesh_xy%J(mesh_xy%nx-1,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2,j,k)*mesh_xy%J(mesh_xy%nx-2,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3,j,k)*mesh_xy%J(mesh_xy%nx-3,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4,j,k)*mesh_xy%J(mesh_xy%nx-4,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5,j,k)*mesh_xy%J(mesh_xy%nx-5,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6,j,k)*mesh_xy%J(mesh_xy%nx-6,j,k)

                  m41 = d040101*b1 + d040102*b2 + d040103*b3 + d040105*b5 + d040106*b6 + d040107*b7
                  m42 = d040201*b1 + d040203*b3 + d040205*b5 + d040206*b6 + d040207*b7
                  m43 = d040301*b1 + d040302*b2 + d040305*b5 + d040306*b6 + d040307*b7
                  m44 = d040401*b1 + d040402*b2 + d040403*b3 + d040405*b5 + d040406*b6 + d040407*b7
                  m45 = d040501*b1 + d040502*b2 + d040503*b3 + d040505*b5 + d040506*b6 + d040507*b7
                  m46 = d040601*b1 + d040602*b2 + d040603*b3 + d040605*b5 + d040606*b6 + d040607*b7
                  m47 = d040705*b5 + d040706*b6 + d040707*b7
                  m48 = d040805*b5 + d040806*b6 + d040807*b7
                  m49 = d040905*b5 + d040906*b6 + d040907*b7

                  d2f_x%p(mesh_xy%nx-3,j,k) = 1.0_8*(m41*f%p(mesh_xy%nx  ,j,k)+m42*f%p(mesh_xy%nx-1,j,k)+m43*f%p(mesh_xy%nx-2,j,k) + &
                                                      m44*f%p(mesh_xy%nx-3,j,k)+m45*f%p(mesh_xy%nx-4,j,k)+m46*f%p(mesh_xy%nx-5,j,k) + &
                                                      m47*f%p(mesh_xy%nx-6,j,k)+m48*f%p(mesh_xy%nx-7,j,k)+m49*f%p(mesh_xy%nx-8,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-4 .and. mesh_xy%ie>=mesh_xy%nx-4) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx   ,j,k)*mesh_xy%J(mesh_xy%nx   ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1 ,j,k)*mesh_xy%J(mesh_xy%nx-1 ,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2 ,j,k)*mesh_xy%J(mesh_xy%nx-2 ,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3 ,j,k)*mesh_xy%J(mesh_xy%nx-3 ,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4 ,j,k)*mesh_xy%J(mesh_xy%nx-4 ,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5 ,j,k)*mesh_xy%J(mesh_xy%nx-5 ,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6 ,j,k)*mesh_xy%J(mesh_xy%nx-6 ,j,k)
                  b8  = mesh_xy%Qi(1,mesh_xy%nx-7 ,j,k)*mesh_xy%J(mesh_xy%nx-7 ,j,k)

                  m51 = d050101*b1 + d050102*b2 + d050103*b3 + d050104*b4 + d050105*b5 + d050106*b6 + d050107*b7
                  m52 = d050201*b1 + d050203*b3 + d050204*b4 + d050205*b5 + d050206*b6 + d050207*b7
                  m53 = d050301*b1 + d050302*b2 + d050304*b4 + d050305*b5 + d050306*b6 + d050307*b7
                  m54 = d050401*b1 + d050402*b2 + d050403*b3 + d050405*b5 + d050406*b6 + d050407*b7
                  m55 = d050501*b1 + d050502*b2 + d050503*b3 + d050504*b4 + d050505*b5 + d050506*b6 + d050507*b7 + d050508*b8
                  m56 = d050601*b1 + d050602*b2 + d050603*b3 + d050604*b4 + d050605*b5 + d050606*b6 + d050607*b7 + d050608*b8
                  m57 = d050704*b4 + d050705*b5 + d050706*b6 + d050707*b7 + d050708*b8
                  m58 = d050805*b5 + d050806*b6 + d050807*b7 + d050808*b8
                  m59 = d050905*b5 + d050906*b6 + d050907*b7 + d050908*b8

                  d2f_x%p(mesh_xy%nx-4,j,k) = 1.0_8*(m51*f%p(mesh_xy%nx  ,j,k)+m52*f%p(mesh_xy%nx-1,j,k)+m53*f%p(mesh_xy%nx-2,j,k) + &
                                                      m54*f%p(mesh_xy%nx-3,j,k)+m55*f%p(mesh_xy%nx-4,j,k)+m56*f%p(mesh_xy%nx-5,j,k) + &
                                                      m57*f%p(mesh_xy%nx-6,j,k)+m58*f%p(mesh_xy%nx-7,j,k)+m59*f%p(mesh_xy%nx-8,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-5 .and. mesh_xy%ie>=mesh_xy%nx-5) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx   ,j,k)*mesh_xy%J(mesh_xy%nx   ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1 ,j,k)*mesh_xy%J(mesh_xy%nx-1 ,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2 ,j,k)*mesh_xy%J(mesh_xy%nx-2 ,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3 ,j,k)*mesh_xy%J(mesh_xy%nx-3 ,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4 ,j,k)*mesh_xy%J(mesh_xy%nx-4 ,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5 ,j,k)*mesh_xy%J(mesh_xy%nx-5 ,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6 ,j,k)*mesh_xy%J(mesh_xy%nx-6 ,j,k)
                  b8  = mesh_xy%Qi(1,mesh_xy%nx-7 ,j,k)*mesh_xy%J(mesh_xy%nx-7 ,j,k)
                  b9  = mesh_xy%Qi(1,mesh_xy%nx-8 ,j,k)*mesh_xy%J(mesh_xy%nx-8 ,j,k)

                  m61 = d060101*b1 + d060102*b2 + d060103*b3 + d060104*b4 + d060105*b5 + d060106*b6 + d060107*b7
                  m62 = d060201*b1 + d060203*b3 + d060204*b4 + d060205*b5 + d060206*b6 + d060207*b7
                  m63 = d060301*b1 + d060302*b2 + d060304*b4 + d060305*b5 + d060306*b6 + d060307*b7
                  m64 = d060401*b1 + d060402*b2 + d060403*b3 + d060405*b5 + d060406*b6 + d060407*b7
                  m65 = d060501*b1 + d060502*b2 + d060503*b3 + d060504*b4 + d060505*b5 + d060506*b6 + d060507*b7 + d060508*b8
                  m66 = d060601*b1 + d060602*b2 + d060603*b3 + d060604*b4 + d060605*b5 + d060606*b6 + d060607*b7 + d060608*b8 + d060609*b9
                  m67 = d060704*b4 + d060705*b5 + d060706*b6 + d060707*b7 + d060708*b8 + d060709*b9
                  m68 = d060805*b5 + d060806*b6 + d060807*b7 + d060808*b8 + d060809*b9
                  m69 = d060905*b5 + d060906*b6 + d060907*b7 + d060908*b8 + d060909*b9

                  d2f_x%p(mesh_xy%nx-5,j,k) = 1.0_8*(m61*f%p(mesh_xy%nx  ,j,k)+m62*f%p(mesh_xy%nx-1,j,k)+m63*f%p(mesh_xy%nx-2,j,k) + &
                                                      m64*f%p(mesh_xy%nx-3,j,k)+m65*f%p(mesh_xy%nx-4,j,k)+m66*f%p(mesh_xy%nx-5,j,k) + &
                                                      m67*f%p(mesh_xy%nx-6,j,k)+m68*f%p(mesh_xy%nx-7,j,k)+m69*f%p(mesh_xy%nx-8,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-6 .and. mesh_xy%ie>=mesh_xy%nx-6) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx   ,j,k)*mesh_xy%J(mesh_xy%nx   ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1 ,j,k)*mesh_xy%J(mesh_xy%nx-1 ,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2 ,j,k)*mesh_xy%J(mesh_xy%nx-2 ,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3 ,j,k)*mesh_xy%J(mesh_xy%nx-3 ,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4 ,j,k)*mesh_xy%J(mesh_xy%nx-4 ,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5 ,j,k)*mesh_xy%J(mesh_xy%nx-5 ,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6 ,j,k)*mesh_xy%J(mesh_xy%nx-6 ,j,k)
                  b8  = mesh_xy%Qi(1,mesh_xy%nx-7 ,j,k)*mesh_xy%J(mesh_xy%nx-7 ,j,k)
                  b9  = mesh_xy%Qi(1,mesh_xy%nx-8 ,j,k)*mesh_xy%J(mesh_xy%nx-8 ,j,k)
                  b10 = mesh_xy%Qi(1,mesh_xy%nx-9 ,j,k)*mesh_xy%J(mesh_xy%nx-9 ,j,k)

                  m71  = d070104*b4 + d070105*b5 + d070106*b6 + d070107*b7
                  m72  = d070204*b4 + d070205*b5 + d070206*b6 + d070207*b7
                  m73  = d070304*b4 + d070305*b5 + d070306*b6 + d070307*b7
                  m74  = d070405*b5 + d070406*b6 + d070407*b7
                  m75  = d070504*b4 + d070505*b5 + d070506*b6 + d070507*b7 + d070508*b8
                  m76  = d070604*b4 + d070605*b5 + d070606*b6 + d070607*b7 + d070608*b8 + d070609*b9
                  m77  = d070704*b4 + d070705*b5 + d070706*b6 + d070707*b7 + d070708*b8 + d070709*b9 + d070710*b10
                  m78  = d070805*b5 + d070806*b6 + d070807*b7 + d070808*b8 + d070809*b9 + d070810*b10
                  m79  = d070905*b5 + d070906*b6 + d070907*b7 + d070908*b8 + d070909*b9 + d070910*b10
                  m710 = d071010*b10 + d071007*b7 + d071008*b8 + d071009*b9

                  d2f_x%p(mesh_xy%nx-6,j,k) = 1.0_8*(m71*f%p(mesh_xy%nx  ,j,k)+m72*f%p(mesh_xy%nx-1,j,k)+m73*f%p(mesh_xy%nx-2,j,k) + &
                                                      m74*f%p(mesh_xy%nx-3,j,k)+m75*f%p(mesh_xy%nx-4,j,k)+m76*f%p(mesh_xy%nx-5,j,k) + &
                                                      m77*f%p(mesh_xy%nx-6,j,k)+m78*f%p(mesh_xy%nx-7,j,k)+m79*f%p(mesh_xy%nx-8,j,k) + &
                                                     m710*f%p(mesh_xy%nx-9,j,k))
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-7 .and. mesh_xy%ie>=mesh_xy%nx-7) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx   ,j,k)*mesh_xy%J(mesh_xy%nx   ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1 ,j,k)*mesh_xy%J(mesh_xy%nx-1 ,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2 ,j,k)*mesh_xy%J(mesh_xy%nx-2 ,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3 ,j,k)*mesh_xy%J(mesh_xy%nx-3 ,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4 ,j,k)*mesh_xy%J(mesh_xy%nx-4 ,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5 ,j,k)*mesh_xy%J(mesh_xy%nx-5 ,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6 ,j,k)*mesh_xy%J(mesh_xy%nx-6 ,j,k)
                  b8  = mesh_xy%Qi(1,mesh_xy%nx-7 ,j,k)*mesh_xy%J(mesh_xy%nx-7 ,j,k)
                  b9  = mesh_xy%Qi(1,mesh_xy%nx-8 ,j,k)*mesh_xy%J(mesh_xy%nx-8 ,j,k)
                  b10 = mesh_xy%Qi(1,mesh_xy%nx-9 ,j,k)*mesh_xy%J(mesh_xy%nx-9 ,j,k)
                  b11 = mesh_xy%Qi(1,mesh_xy%nx-10,j,k)*mesh_xy%J(mesh_xy%nx-10,j,k)

                  m81  = d080105*b5 + d080106*b6 + d080107*b7
                  m82  = d080205*b5 + d080206*b6 + d080207*b7
                  m83  = d080305*b5 + d080306*b6 + d080307*b7
                  m84  = d080405*b5 + d080406*b6 + d080407*b7
                  m85  = d080505*b5 + d080506*b6 + d080507*b7 + d080508*b8
                  m86  = d080605*b5 + d080606*b6 + d080607*b7 + d080608*b8 + d080609*b9
                  m87  = d080705*b5 + d080706*b6 + d080707*b7 + d080708*b8 + d080709*b9 + d080710*b10
                  m88  = d080805*b5 + d080806*b6 + d080807*b7 + d080808*b8 + d080809*b9 + d080810*b10 + d080811*b11
                  m89  = d080910*b10 + d080911*b11 + d080905*b5 + d080906*b6 + d080907*b7 + d080908*b8 + d080909*b9
                  m810 = d081010*b10 + d081011*b11 + d081007*b7 + d081008*b8 + d081009*b9
                  m811 = d081110*b10 + d081111*b11 + d081108*b8 + d081109*b9

                  d2f_x%p(mesh_xy%nx-7,j,k) = 1.0_8*(m81*f%p(mesh_xy%nx  ,j,k)+ m82*f%p(mesh_xy%nx-1 ,j,k)+m83*f%p(mesh_xy%nx-2,j,k) + &
                                                      m84*f%p(mesh_xy%nx-3,j,k)+ m85*f%p(mesh_xy%nx-4 ,j,k)+m86*f%p(mesh_xy%nx-5,j,k) + &
                                                      m87*f%p(mesh_xy%nx-6,j,k)+ m88*f%p(mesh_xy%nx-7 ,j,k)+m89*f%p(mesh_xy%nx-8,j,k) + &
                                                     m810*f%p(mesh_xy%nx-9,j,k)+m811*f%p(mesh_xy%nx-10,j,k) )
              end do
          end if
          if (mesh_xy%is<=mesh_xy%nx-8 .and. mesh_xy%ie>=mesh_xy%nx-8) then
              do j = mesh_xy%js, mesh_xy%je

                  b1  = mesh_xy%Qi(1,mesh_xy%nx   ,j,k)*mesh_xy%J(mesh_xy%nx   ,j,k)
                  b2  = mesh_xy%Qi(1,mesh_xy%nx-1 ,j,k)*mesh_xy%J(mesh_xy%nx-1 ,j,k)
                  b3  = mesh_xy%Qi(1,mesh_xy%nx-2 ,j,k)*mesh_xy%J(mesh_xy%nx-2 ,j,k)
                  b4  = mesh_xy%Qi(1,mesh_xy%nx-3 ,j,k)*mesh_xy%J(mesh_xy%nx-3 ,j,k)
                  b5  = mesh_xy%Qi(1,mesh_xy%nx-4 ,j,k)*mesh_xy%J(mesh_xy%nx-4 ,j,k)
                  b6  = mesh_xy%Qi(1,mesh_xy%nx-5 ,j,k)*mesh_xy%J(mesh_xy%nx-5 ,j,k)
                  b7  = mesh_xy%Qi(1,mesh_xy%nx-6 ,j,k)*mesh_xy%J(mesh_xy%nx-6 ,j,k)
                  b8  = mesh_xy%Qi(1,mesh_xy%nx-7 ,j,k)*mesh_xy%J(mesh_xy%nx-7 ,j,k)
                  b9  = mesh_xy%Qi(1,mesh_xy%nx-8 ,j,k)*mesh_xy%J(mesh_xy%nx-8 ,j,k)
                  b10 = mesh_xy%Qi(1,mesh_xy%nx-9 ,j,k)*mesh_xy%J(mesh_xy%nx-9 ,j,k)
                  b11 = mesh_xy%Qi(1,mesh_xy%nx-10,j,k)*mesh_xy%J(mesh_xy%nx-10,j,k)
                  b12 = mesh_xy%Qi(1,mesh_xy%nx-11,j,k)*mesh_xy%J(mesh_xy%nx-11,j,k)

                  m91  = d090105*b5 + d090106*b6 + d090107*b7
                  m92  = d090205*b5 + d090206*b6 + d090207*b7
                  m93  = d090305*b5 + d090306*b6 + d090307*b7
                  m94  = d090405*b5 + d090406*b6 + d090407*b7
                  m95  = d090505*b5 + d090506*b6 + d090507*b7 + d090508*b8
                  m96  = d090605*b5 + d090606*b6 + d090607*b7 + d090608*b8 + d090609*b9
                  m97  = d090705*b5 + d090706*b6 + d090707*b7 + d090708*b8 + d090709*b9 + d090710*b10
                  m98  = d090810*b10 + d090811*b11 + d090805*b5 + d090806*b6 + d090807*b7 + d090808*b8 + d090809*b9
                  m99  = d090910*b10 + d090911*b11 + d090912*b12 + d090905*b5 + d090906*b6 + d090907*b7 + d090908*b8 + d090909*b9
                  m910 = d091010*b10 + d091011*b11 + d091012*b12 + d091007*b7 + d091008*b8 + d091009*b9
                  m911 = d091110*b10 + d091111*b11 + d091112*b12 + d091108*b8 + d091109*b9
                  m912 = d091210*b10 + d091211*b11 + d091212*b12 + d091209*b9


                  d2f_x%p(mesh_xy%nx-8,j,k) = 1.0_8*(m91*f%p(mesh_xy%nx  ,j,k)+ m92*f%p(mesh_xy%nx-1 ,j,k)+ m93*f%p(mesh_xy%nx-2 ,j,k) + &
                                                      m94*f%p(mesh_xy%nx-3,j,k)+ m95*f%p(mesh_xy%nx-4 ,j,k)+ m96*f%p(mesh_xy%nx-5 ,j,k) + &
                                                      m97*f%p(mesh_xy%nx-6,j,k)+ m98*f%p(mesh_xy%nx-7 ,j,k)+ m99*f%p(mesh_xy%nx-8 ,j,k) + &
                                                     m910*f%p(mesh_xy%nx-9,j,k)+m911*f%p(mesh_xy%nx-10,j,k)+m912*f%p(mesh_xy%nx-11,j,k) )
              end do
          end if
          if (mesh_xy%js<=1 .and. mesh_xy%je>=1) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)

                  m11 = d010101*b1 + d010102*b2 + d010103*b3 + d010104*b4 + d010105*b5 + d010106*b6 + d010107*b7
                  m12 = d010201*b1 + d010203*b3 + d010204*b4 + d010205*b5 + d010206*b6 + d010207*b7
                  m13 = d010301*b1 + d010302*b2 + d010304*b4 + d010305*b5 + d010306*b6 + d010307*b7
                  m14 = d010401*b1 + d010402*b2 + d010403*b3 + d010405*b5 + d010406*b6 + d010407*b7
                  m15 = d010501*b1 + d010502*b2 + d010503*b3 + d010504*b4 + d010505*b5 + d010506*b6 + d010507*b7
                  m16 = d010601*b1 + d010602*b2 + d010603*b3 + d010604*b4 + d010605*b5 + d010606*b6 + d010607*b7
                  m17 = d010704*b4 + d010705*b5 + d010706*b6 + d010707*b7
                  m18 = d010805*b5 + d010806*b6 + d010807*b7
                  m19 = d010905*b5 + d010906*b6 + d010907*b7

                  d2f_y%p(i,1,k) = 1.0_8*( m11*f%p(i,1,k)+ m12*f%p(i,2,k)+ m13*f%p(i,3,k) + &
                                            m14*f%p(i,4,k)+ m15*f%p(i,5,k)+ m16*f%p(i,6,k) + &
                                            m17*f%p(i,7,k)+ m18*f%p(i,8,k)+ m19*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=2 .and. mesh_xy%je>=2) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)

                  m21 = d020101*b1 + d020103*b3 + d020104*b4 + d020105*b5 + d020106*b6 + d020107*b7
                  m22 = d020201*b1 + d020203*b3 + d020204*b4 + d020205*b5 + d020206*b6 + d020207*b7
                  m23 = d020301*b1 + d020304*b4 + d020305*b5 + d020306*b6 + d020307*b7
                  m24 = d020401*b1 + d020403*b3 + d020405*b5 + d020406*b6 + d020407*b7
                  m25 = d020501*b1 + d020503*b3 + d020504*b4 + d020505*b5 + d020506*b6 + d020507*b7
                  m26 = d020601*b1 + d020603*b3 + d020604*b4 + d020605*b5 + d020606*b6 + d020607*b7
                  m27 = d020704*b4 + d020705*b5 + d020706*b6 + d020707*b7
                  m28 = d020805*b5 + d020806*b6 + d020807*b7
                  m29 = d020905*b5 + d020906*b6 + d020907*b7

                  d2f_y%p(i,2,k) = 1.0_8*( m21*f%p(i,1,k)+ m22*f%p(i,2,k)+ m23*f%p(i,3,k) + &
                                            m24*f%p(i,4,k)+ m25*f%p(i,5,k)+ m26*f%p(i,6,k) + &
                                            m27*f%p(i,7,k)+ m28*f%p(i,8,k)+ m29*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=3 .and. mesh_xy%je>=3) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)

                  m31 = d030101*b1 + d030102*b2 + d030104*b4 + d030105*b5 + d030106*b6 + d030107*b7
                  m32 = d030201*b1 + d030204*b4 + d030205*b5 + d030206*b6 + d030207*b7
                  m33 = d030301*b1 + d030302*b2 + d030304*b4 + d030305*b5 + d030306*b6 + d030307*b7
                  m34 = d030401*b1 + d030402*b2 + d030405*b5 + d030406*b6 + d030407*b7
                  m35 = d030501*b1 + d030502*b2 + d030504*b4 + d030505*b5 + d030506*b6 + d030507*b7
                  m36 = d030601*b1 + d030602*b2 + d030604*b4 + d030605*b5 + d030606*b6 + d030607*b7
                  m37 = d030704*b4 + d030705*b5 + d030706*b6 + d030707*b7
                  m38 = d030805*b5 + d030806*b6 + d030807*b7
                  m39 = d030905*b5 + d030906*b6 + d030907*b7

                  d2f_y%p(i,3,k) = 1.0_8*( m31*f%p(i,1,k)+ m32*f%p(i,2,k)+ m33*f%p(i,3,k) + &
                                            m34*f%p(i,4,k)+ m35*f%p(i,5,k)+ m36*f%p(i,6,k) + &
                                            m37*f%p(i,7,k)+ m38*f%p(i,8,k)+ m39*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=4 .and. mesh_xy%je>=4) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)

                  m41 = d040101*b1 + d040102*b2 + d040103*b3 + d040105*b5 + d040106*b6 + d040107*b7
                  m42 = d040201*b1 + d040203*b3 + d040205*b5 + d040206*b6 + d040207*b7
                  m43 = d040301*b1 + d040302*b2 + d040305*b5 + d040306*b6 + d040307*b7
                  m44 = d040401*b1 + d040402*b2 + d040403*b3 + d040405*b5 + d040406*b6 + d040407*b7
                  m45 = d040501*b1 + d040502*b2 + d040503*b3 + d040505*b5 + d040506*b6 + d040507*b7
                  m46 = d040601*b1 + d040602*b2 + d040603*b3 + d040605*b5 + d040606*b6 + d040607*b7
                  m47 = d040705*b5 + d040706*b6 + d040707*b7
                  m48 = d040805*b5 + d040806*b6 + d040807*b7
                  m49 = d040905*b5 + d040906*b6 + d040907*b7

                  d2f_y%p(i,4,k) = 1.0_8*( m41*f%p(i,1,k)+ m42*f%p(i,2,k)+ m43*f%p(i,3,k) + &
                                            m44*f%p(i,4,k)+ m45*f%p(i,5,k)+ m46*f%p(i,6,k) + &
                                            m47*f%p(i,7,k)+ m48*f%p(i,8,k)+ m49*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=5 .and. mesh_xy%je>=5) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)
                  b8  = mesh_xy%Qi(3,i,8 ,k)*mesh_xy%J(i,8 ,k)

                  m51 = d050101*b1 + d050102*b2 + d050103*b3 + d050104*b4 + d050105*b5 + d050106*b6 + d050107*b7
                  m52 = d050201*b1 + d050203*b3 + d050204*b4 + d050205*b5 + d050206*b6 + d050207*b7
                  m53 = d050301*b1 + d050302*b2 + d050304*b4 + d050305*b5 + d050306*b6 + d050307*b7
                  m54 = d050401*b1 + d050402*b2 + d050403*b3 + d050405*b5 + d050406*b6 + d050407*b7
                  m55 = d050501*b1 + d050502*b2 + d050503*b3 + d050504*b4 + d050505*b5 + d050506*b6 + d050507*b7 + d050508*b8
                  m56 = d050601*b1 + d050602*b2 + d050603*b3 + d050604*b4 + d050605*b5 + d050606*b6 + d050607*b7 + d050608*b8
                  m57 = d050704*b4 + d050705*b5 + d050706*b6 + d050707*b7 + d050708*b8
                  m58 = d050805*b5 + d050806*b6 + d050807*b7 + d050808*b8
                  m59 = d050905*b5 + d050906*b6 + d050907*b7 + d050908*b8

                  d2f_y%p(i,5,k) = 1.0_8*( m51*f%p(i,1,k)+ m52*f%p(i,2,k)+ m53*f%p(i,3,k) + &
                                            m54*f%p(i,4,k)+ m55*f%p(i,5,k)+ m56*f%p(i,6,k) + &
                                            m57*f%p(i,7,k)+ m58*f%p(i,8,k)+ m59*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=6 .and. mesh_xy%je>=6) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)
                  b8  = mesh_xy%Qi(3,i,8 ,k)*mesh_xy%J(i,8 ,k)
                  b9  = mesh_xy%Qi(3,i,9 ,k)*mesh_xy%J(i,9 ,k)

                  m61 = d060101*b1 + d060102*b2 + d060103*b3 + d060104*b4 + d060105*b5 + d060106*b6 + d060107*b7
                  m62 = d060201*b1 + d060203*b3 + d060204*b4 + d060205*b5 + d060206*b6 + d060207*b7
                  m63 = d060301*b1 + d060302*b2 + d060304*b4 + d060305*b5 + d060306*b6 + d060307*b7
                  m64 = d060401*b1 + d060402*b2 + d060403*b3 + d060405*b5 + d060406*b6 + d060407*b7
                  m65 = d060501*b1 + d060502*b2 + d060503*b3 + d060504*b4 + d060505*b5 + d060506*b6 + d060507*b7 + d060508*b8
                  m66 = d060601*b1 + d060602*b2 + d060603*b3 + d060604*b4 + d060605*b5 + d060606*b6 + d060607*b7 + d060608*b8 + d060609*b9
                  m67 = d060704*b4 + d060705*b5 + d060706*b6 + d060707*b7 + d060708*b8 + d060709*b9
                  m68 = d060805*b5 + d060806*b6 + d060807*b7 + d060808*b8 + d060809*b9
                  m69 = d060905*b5 + d060906*b6 + d060907*b7 + d060908*b8 + d060909*b9

                  d2f_y%p(i,6,k) = 1.0_8*( m61*f%p(i,1,k)+ m62*f%p(i,2,k)+ m63*f%p(i,3,k) + &
                                            m64*f%p(i,4,k)+ m65*f%p(i,5,k)+ m66*f%p(i,6,k) + &
                                            m67*f%p(i,7,k)+ m68*f%p(i,8,k)+ m69*f%p(i,9,k) )
              end do
          end if
          if (mesh_xy%js<=7 .and. mesh_xy%je>=7) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)
                  b8  = mesh_xy%Qi(3,i,8 ,k)*mesh_xy%J(i,8 ,k)
                  b9  = mesh_xy%Qi(3,i,9 ,k)*mesh_xy%J(i,9 ,k)
                  b10 = mesh_xy%Qi(3,i,10,k)*mesh_xy%J(i,10,k)

                  m71  = d070104*b4 + d070105*b5 + d070106*b6 + d070107*b7
                  m72  = d070204*b4 + d070205*b5 + d070206*b6 + d070207*b7
                  m73  = d070304*b4 + d070305*b5 + d070306*b6 + d070307*b7
                  m74  = d070405*b5 + d070406*b6 + d070407*b7
                  m75  = d070504*b4 + d070505*b5 + d070506*b6 + d070507*b7 + d070508*b8
                  m76  = d070604*b4 + d070605*b5 + d070606*b6 + d070607*b7 + d070608*b8 + d070609*b9
                  m77  = d070704*b4 + d070705*b5 + d070706*b6 + d070707*b7 + d070708*b8 + d070709*b9 + d070710*b10
                  m78  = d070805*b5 + d070806*b6 + d070807*b7 + d070808*b8 + d070809*b9 + d070810*b10
                  m79  = d070905*b5 + d070906*b6 + d070907*b7 + d070908*b8 + d070909*b9 + d070910*b10
                  m710 = d071010*b10 + d071007*b7 + d071008*b8 + d071009*b9

                  d2f_y%p(i,7,k) = 1.0_8*( m71*f%p(i, 1,k)+ m72*f%p(i,2,k)+ m73*f%p(i,3,k) + &
                                            m74*f%p(i, 4,k)+ m75*f%p(i,5,k)+ m76*f%p(i,6,k) + &
                                            m77*f%p(i, 7,k)+ m78*f%p(i,8,k)+ m79*f%p(i,9,k) + &
                                           m710*f%p(i,10,k) )
              end do
          end if
          if (mesh_xy%js<=8 .and. mesh_xy%je>=8) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)
                  b8  = mesh_xy%Qi(3,i,8 ,k)*mesh_xy%J(i,8 ,k)
                  b9  = mesh_xy%Qi(3,i,9 ,k)*mesh_xy%J(i,9 ,k)
                  b10 = mesh_xy%Qi(3,i,10,k)*mesh_xy%J(i,10,k)
                  b11 = mesh_xy%Qi(3,i,11,k)*mesh_xy%J(i,11,k)

                  m81  = d080105*b5 + d080106*b6 + d080107*b7
                  m82  = d080205*b5 + d080206*b6 + d080207*b7
                  m83  = d080305*b5 + d080306*b6 + d080307*b7
                  m84  = d080405*b5 + d080406*b6 + d080407*b7
                  m85  = d080505*b5 + d080506*b6 + d080507*b7 + d080508*b8
                  m86  = d080605*b5 + d080606*b6 + d080607*b7 + d080608*b8 + d080609*b9
                  m87  = d080705*b5 + d080706*b6 + d080707*b7 + d080708*b8 + d080709*b9 + d080710*b10
                  m88  = d080805*b5 + d080806*b6 + d080807*b7 + d080808*b8 + d080809*b9 + d080810*b10 + d080811*b11
                  m89  = d080910*b10 + d080911*b11 + d080905*b5 + d080906*b6 + d080907*b7 + d080908*b8 + d080909*b9
                  m810 = d081010*b10 + d081011*b11 + d081007*b7 + d081008*b8 + d081009*b9
                  m811 = d081110*b10 + d081111*b11 + d081108*b8 + d081109*b9

                  d2f_y%p(i,8,k) = 1.0_8*( m81*f%p(i, 1,k)+ m82*f%p(i, 2,k)+ m83*f%p(i, 3,k) + &
                                            m84*f%p(i, 4,k)+ m85*f%p(i, 5,k)+ m86*f%p(i, 6,k) + &
                                            m87*f%p(i, 7,k)+ m88*f%p(i, 8,k)+ m89*f%p(i, 9,k) + &
                                           m810*f%p(i,10,k)+m811*f%p(i,11,k))
              end do
          end if
          if (mesh_xy%js<=9 .and. mesh_xy%je>=9) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,1 ,k)*mesh_xy%J(i,1 ,k)
                  b2  = mesh_xy%Qi(3,i,2 ,k)*mesh_xy%J(i,2 ,k)
                  b3  = mesh_xy%Qi(3,i,3 ,k)*mesh_xy%J(i,3 ,k)
                  b4  = mesh_xy%Qi(3,i,4 ,k)*mesh_xy%J(i,4 ,k)
                  b5  = mesh_xy%Qi(3,i,5 ,k)*mesh_xy%J(i,5 ,k)
                  b6  = mesh_xy%Qi(3,i,6 ,k)*mesh_xy%J(i,6 ,k)
                  b7  = mesh_xy%Qi(3,i,7 ,k)*mesh_xy%J(i,7 ,k)
                  b8  = mesh_xy%Qi(3,i,8 ,k)*mesh_xy%J(i,8 ,k)
                  b9  = mesh_xy%Qi(3,i,9 ,k)*mesh_xy%J(i,9 ,k)
                  b10 = mesh_xy%Qi(3,i,10,k)*mesh_xy%J(i,10,k)
                  b11 = mesh_xy%Qi(3,i,11,k)*mesh_xy%J(i,11,k)
                  b12 = mesh_xy%Qi(3,i,12,k)*mesh_xy%J(i,12,k)

                  m91  = d090105*b5 + d090106*b6 + d090107*b7
                  m92  = d090205*b5 + d090206*b6 + d090207*b7
                  m93  = d090305*b5 + d090306*b6 + d090307*b7
                  m94  = d090405*b5 + d090406*b6 + d090407*b7
                  m95  = d090505*b5 + d090506*b6 + d090507*b7 + d090508*b8
                  m96  = d090605*b5 + d090606*b6 + d090607*b7 + d090608*b8 + d090609*b9
                  m97  = d090705*b5 + d090706*b6 + d090707*b7 + d090708*b8 + d090709*b9 + d090710*b10
                  m98  = d090810*b10 + d090811*b11 + d090805*b5 + d090806*b6 + d090807*b7 + d090808*b8 + d090809*b9
                  m99  = d090910*b10 + d090911*b11 + d090912*b12 + d090905*b5 + d090906*b6 + d090907*b7 + d090908*b8 + d090909*b9
                  m910 = d091010*b10 + d091011*b11 + d091012*b12 + d091007*b7 + d091008*b8 + d091009*b9
                  m911 = d091110*b10 + d091111*b11 + d091112*b12 + d091108*b8 + d091109*b9
                  m912 = d091210*b10 + d091211*b11 + d091212*b12 + d091209*b9

                  d2f_y%p(i,9,k) = 1.0_8*( m91*f%p(i, 1,k)+ m92*f%p(i, 2,k)+ m93*f%p(i, 3,k) + &
                                           m94*f%p(i, 4,k)+ m95*f%p(i, 5,k)+ m96*f%p(i, 6,k) + &
                                           m97*f%p(i, 7,k)+ m98*f%p(i, 8,k)+ m99*f%p(i, 9,k) + &
                                          m910*f%p(i,10,k)+m911*f%p(i,11,k)+m912*f%p(i,12,k))
              end do
          end if
          do j = max(mesh_xy%js,10), min(mesh_xy%je,mesh_xy%ny-9)
              do i = mesh_xy%is, mesh_xy%ie

                  bmmm = mesh_xy%Qi(3,i,j-3,k)*mesh_xy%J(i,j-3,k)
                  bmm  = mesh_xy%Qi(3,i,j-2,k)*mesh_xy%J(i,j-2,k)
                  bm   = mesh_xy%Qi(3,i,j-1,k)*mesh_xy%J(i,j-1,k)
                  bc   = mesh_xy%Qi(3,i,j  ,k)*mesh_xy%J(i,j  ,k)
                  bp   = mesh_xy%Qi(3,i,j+1,k)*mesh_xy%J(i,j+1,k)
                  bpp  = mesh_xy%Qi(3,i,j+2,k)*mesh_xy%J(i,j+2,k)
                  bppp = mesh_xy%Qi(3,i,j+3,k)*mesh_xy%J(i,j+3,k)


                  cmmm = di_im3_im3*bmmm + di_im3_im2*bmm + di_im3_im1*bm + di_im3_i_0*bc
                  cmm  = di_im2_im3*bmmm + di_im2_im2*bmm + di_im2_im1*bm + di_im2_i_0*bc + di_im2_ip1*bp
                  cm   = di_im1_im3*bmmm + di_im1_im2*bmm + di_im1_im1*bm + di_im1_i_0*bc + di_im1_ip1*bp + di_im1_ip2*bpp
                  cc   = di_i_0_im3*bmmm + di_i_0_im2*bmm + di_i_0_im1*bm + di_i_0_i_0*bc + di_i_0_ip1*bp + di_i_0_ip2*bpp + di_i_0_ip3*bppp
                  cp   = di_im1_im3*bppp + di_im1_im2*bpp + di_im1_im1*bp + di_im1_i_0*bc + di_im1_ip1*bm + di_im1_ip2*bmm
                  cpp  = di_im2_im3*bppp + di_im2_im2*bpp + di_im2_im1*bp + di_im2_i_0*bc + di_im2_ip1*bm
                  cppp = di_im3_im3*bppp + di_im3_im2*bpp + di_im3_im1*bp + di_im3_i_0*bc

                  d2f_y%p(i,j,k) = (cmmm*f%p(i,j-3,k)+cmm*f%p(i,j-2,k)+cm*f%p(i,j-1,k)+cc*f%p(i,j,k) + &
                                      cp*f%p(i,j+1,k)+cpp*f%p(i,j+2,k)+cppp*f%p(i,j+3,k))
              end do
          end do
          if (mesh_xy%js<=mesh_xy%ny .and. mesh_xy%je>=mesh_xy%ny) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)

                  m11 = d010101*b1 + d010102*b2 + d010103*b3 + d010104*b4 + d010105*b5 + d010106*b6 + d010107*b7
                  m12 = d010201*b1 + d010203*b3 + d010204*b4 + d010205*b5 + d010206*b6 + d010207*b7
                  m13 = d010301*b1 + d010302*b2 + d010304*b4 + d010305*b5 + d010306*b6 + d010307*b7
                  m14 = d010401*b1 + d010402*b2 + d010403*b3 + d010405*b5 + d010406*b6 + d010407*b7
                  m15 = d010501*b1 + d010502*b2 + d010503*b3 + d010504*b4 + d010505*b5 + d010506*b6 + d010507*b7
                  m16 = d010601*b1 + d010602*b2 + d010603*b3 + d010604*b4 + d010605*b5 + d010606*b6 + d010607*b7
                  m17 = d010704*b4 + d010705*b5 + d010706*b6 + d010707*b7
                  m18 = d010805*b5 + d010806*b6 + d010807*b7
                  m19 = d010905*b5 + d010906*b6 + d010907*b7

                  d2f_y%p(i,mesh_xy%ny,k) = 1.0_8*(m11*f%p(i,mesh_xy%ny  ,k)+ m12*f%p(i,mesh_xy%ny-1,k)+ m13*f%p(i,mesh_xy%ny-2,k) + &
                                                   m14*f%p(i,mesh_xy%ny-3,k)+ m15*f%p(i,mesh_xy%ny-4,k)+ m16*f%p(i,mesh_xy%ny-5,k) + &
                                                   m17*f%p(i,mesh_xy%ny-6,k)+ m18*f%p(i,mesh_xy%ny-7,k)+ m19*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-1 .and. mesh_xy%je>=mesh_xy%ny-1) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)

                  m21 = d020101*b1 + d020103*b3 + d020104*b4 + d020105*b5 + d020106*b6 + d020107*b7
                  m22 = d020201*b1 + d020203*b3 + d020204*b4 + d020205*b5 + d020206*b6 + d020207*b7
                  m23 = d020301*b1 + d020304*b4 + d020305*b5 + d020306*b6 + d020307*b7
                  m24 = d020401*b1 + d020403*b3 + d020405*b5 + d020406*b6 + d020407*b7
                  m25 = d020501*b1 + d020503*b3 + d020504*b4 + d020505*b5 + d020506*b6 + d020507*b7
                  m26 = d020601*b1 + d020603*b3 + d020604*b4 + d020605*b5 + d020606*b6 + d020607*b7
                  m27 = d020704*b4 + d020705*b5 + d020706*b6 + d020707*b7
                  m28 = d020805*b5 + d020806*b6 + d020807*b7
                  m29 = d020905*b5 + d020906*b6 + d020907*b7

                  d2f_y%p(i,mesh_xy%ny-1,k) = 1.0_8*(m21*f%p(i,mesh_xy%ny  ,k)+ m22*f%p(i,mesh_xy%ny-1,k)+ m23*f%p(i,mesh_xy%ny-2,k) + &
                                                     m24*f%p(i,mesh_xy%ny-3,k)+ m25*f%p(i,mesh_xy%ny-4,k)+ m26*f%p(i,mesh_xy%ny-5,k) + &
                                                     m27*f%p(i,mesh_xy%ny-6,k)+ m28*f%p(i,mesh_xy%ny-7,k)+ m29*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-2 .and. mesh_xy%je>=mesh_xy%ny-2) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)

                  m31 = d030101*b1 + d030102*b2 + d030104*b4 + d030105*b5 + d030106*b6 + d030107*b7
                  m32 = d030201*b1 + d030204*b4 + d030205*b5 + d030206*b6 + d030207*b7
                  m33 = d030301*b1 + d030302*b2 + d030304*b4 + d030305*b5 + d030306*b6 + d030307*b7
                  m34 = d030401*b1 + d030402*b2 + d030405*b5 + d030406*b6 + d030407*b7
                  m35 = d030501*b1 + d030502*b2 + d030504*b4 + d030505*b5 + d030506*b6 + d030507*b7
                  m36 = d030601*b1 + d030602*b2 + d030604*b4 + d030605*b5 + d030606*b6 + d030607*b7
                  m37 = d030704*b4 + d030705*b5 + d030706*b6 + d030707*b7
                  m38 = d030805*b5 + d030806*b6 + d030807*b7
                  m39 = d030905*b5 + d030906*b6 + d030907*b7

                  d2f_y%p(i,mesh_xy%ny-2,k) = 1.0_8*(m31*f%p(i,mesh_xy%ny  ,k)+ m32*f%p(i,mesh_xy%ny-1,k)+ m33*f%p(i,mesh_xy%ny-2,k) + &
                                                      m34*f%p(i,mesh_xy%ny-3,k)+ m35*f%p(i,mesh_xy%ny-4,k)+ m36*f%p(i,mesh_xy%ny-5,k) + &
                                                      m37*f%p(i,mesh_xy%ny-6,k)+ m38*f%p(i,mesh_xy%ny-7,k)+ m39*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-3 .and. mesh_xy%je>=mesh_xy%ny-3) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)

                  m41 = d040101*b1 + d040102*b2 + d040103*b3 + d040105*b5 + d040106*b6 + d040107*b7
                  m42 = d040201*b1 + d040203*b3 + d040205*b5 + d040206*b6 + d040207*b7
                  m43 = d040301*b1 + d040302*b2 + d040305*b5 + d040306*b6 + d040307*b7
                  m44 = d040401*b1 + d040402*b2 + d040403*b3 + d040405*b5 + d040406*b6 + d040407*b7
                  m45 = d040501*b1 + d040502*b2 + d040503*b3 + d040505*b5 + d040506*b6 + d040507*b7
                  m46 = d040601*b1 + d040602*b2 + d040603*b3 + d040605*b5 + d040606*b6 + d040607*b7
                  m47 = d040705*b5 + d040706*b6 + d040707*b7
                  m48 = d040805*b5 + d040806*b6 + d040807*b7
                  m49 = d040905*b5 + d040906*b6 + d040907*b7

                  d2f_y%p(i,mesh_xy%ny-3,k) = 1.0_8*(m41*f%p(i,mesh_xy%ny  ,k)+ m42*f%p(i,mesh_xy%ny-1,k)+ m43*f%p(i,mesh_xy%ny-2,k) + &
                                                      m44*f%p(i,mesh_xy%ny-3,k)+ m45*f%p(i,mesh_xy%ny-4,k)+ m46*f%p(i,mesh_xy%ny-5,k) + &
                                                      m47*f%p(i,mesh_xy%ny-6,k)+ m48*f%p(i,mesh_xy%ny-7,k)+ m49*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-4 .and. mesh_xy%je>=mesh_xy%ny-4) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)
                  b8  = mesh_xy%Qi(3,i,mesh_xy%ny-7 ,k)*mesh_xy%J(i,mesh_xy%ny-7 ,k)

                  m51 = d050101*b1 + d050102*b2 + d050103*b3 + d050104*b4 + d050105*b5 + d050106*b6 + d050107*b7
                  m52 = d050201*b1 + d050203*b3 + d050204*b4 + d050205*b5 + d050206*b6 + d050207*b7
                  m53 = d050301*b1 + d050302*b2 + d050304*b4 + d050305*b5 + d050306*b6 + d050307*b7
                  m54 = d050401*b1 + d050402*b2 + d050403*b3 + d050405*b5 + d050406*b6 + d050407*b7
                  m55 = d050501*b1 + d050502*b2 + d050503*b3 + d050504*b4 + d050505*b5 + d050506*b6 + d050507*b7 + d050508*b8
                  m56 = d050601*b1 + d050602*b2 + d050603*b3 + d050604*b4 + d050605*b5 + d050606*b6 + d050607*b7 + d050608*b8
                  m57 = d050704*b4 + d050705*b5 + d050706*b6 + d050707*b7 + d050708*b8
                  m58 = d050805*b5 + d050806*b6 + d050807*b7 + d050808*b8
                  m59 = d050905*b5 + d050906*b6 + d050907*b7 + d050908*b8

                  d2f_y%p(i,mesh_xy%ny-4,k) = 1.0_8*(m51*f%p(i,mesh_xy%ny  ,k)+ m52*f%p(i,mesh_xy%ny-1,k)+ m53*f%p(i,mesh_xy%ny-2,k) + &
                                                      m54*f%p(i,mesh_xy%ny-3,k)+ m55*f%p(i,mesh_xy%ny-4,k)+ m56*f%p(i,mesh_xy%ny-5,k) + &
                                                      m57*f%p(i,mesh_xy%ny-6,k)+ m58*f%p(i,mesh_xy%ny-7,k)+ m59*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-5 .and. mesh_xy%je>=mesh_xy%ny-5) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)
                  b8  = mesh_xy%Qi(3,i,mesh_xy%ny-7 ,k)*mesh_xy%J(i,mesh_xy%ny-7 ,k)
                  b9  = mesh_xy%Qi(3,i,mesh_xy%ny-8 ,k)*mesh_xy%J(i,mesh_xy%ny-8 ,k)

                  m61 = d060101*b1 + d060102*b2 + d060103*b3 + d060104*b4 + d060105*b5 + d060106*b6 + d060107*b7
                  m62 = d060201*b1 + d060203*b3 + d060204*b4 + d060205*b5 + d060206*b6 + d060207*b7
                  m63 = d060301*b1 + d060302*b2 + d060304*b4 + d060305*b5 + d060306*b6 + d060307*b7
                  m64 = d060401*b1 + d060402*b2 + d060403*b3 + d060405*b5 + d060406*b6 + d060407*b7
                  m65 = d060501*b1 + d060502*b2 + d060503*b3 + d060504*b4 + d060505*b5 + d060506*b6 + d060507*b7 + d060508*b8
                  m66 = d060601*b1 + d060602*b2 + d060603*b3 + d060604*b4 + d060605*b5 + d060606*b6 + d060607*b7 + d060608*b8 + d060609*b9
                  m67 = d060704*b4 + d060705*b5 + d060706*b6 + d060707*b7 + d060708*b8 + d060709*b9
                  m68 = d060805*b5 + d060806*b6 + d060807*b7 + d060808*b8 + d060809*b9
                  m69 = d060905*b5 + d060906*b6 + d060907*b7 + d060908*b8 + d060909*b9

                  d2f_y%p(i,mesh_xy%ny-5,k) = 1.0_8*(m61*f%p(i,mesh_xy%ny  ,k)+ m62*f%p(i,mesh_xy%ny-1,k)+ m63*f%p(i,mesh_xy%ny-2,k) + &
                                                      m64*f%p(i,mesh_xy%ny-3,k)+ m65*f%p(i,mesh_xy%ny-4,k)+ m66*f%p(i,mesh_xy%ny-5,k) + &
                                                      m67*f%p(i,mesh_xy%ny-6,k)+ m68*f%p(i,mesh_xy%ny-7,k)+ m69*f%p(i,mesh_xy%ny-8,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-6 .and. mesh_xy%je>=mesh_xy%ny-6) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)
                  b8  = mesh_xy%Qi(3,i,mesh_xy%ny-7 ,k)*mesh_xy%J(i,mesh_xy%ny-7 ,k)
                  b9  = mesh_xy%Qi(3,i,mesh_xy%ny-8 ,k)*mesh_xy%J(i,mesh_xy%ny-8 ,k)
                  b10 = mesh_xy%Qi(3,i,mesh_xy%ny-9 ,k)*mesh_xy%J(i,mesh_xy%ny-9 ,k)

                  m71  = d070104*b4 + d070105*b5 + d070106*b6 + d070107*b7
                  m72  = d070204*b4 + d070205*b5 + d070206*b6 + d070207*b7
                  m73  = d070304*b4 + d070305*b5 + d070306*b6 + d070307*b7
                  m74  = d070405*b5 + d070406*b6 + d070407*b7
                  m75  = d070504*b4 + d070505*b5 + d070506*b6 + d070507*b7 + d070508*b8
                  m76  = d070604*b4 + d070605*b5 + d070606*b6 + d070607*b7 + d070608*b8 + d070609*b9
                  m77  = d070704*b4 + d070705*b5 + d070706*b6 + d070707*b7 + d070708*b8 + d070709*b9 + d070710*b10
                  m78  = d070805*b5 + d070806*b6 + d070807*b7 + d070808*b8 + d070809*b9 + d070810*b10
                  m79  = d070905*b5 + d070906*b6 + d070907*b7 + d070908*b8 + d070909*b9 + d070910*b10
                  m710 = d071010*b10 + d071007*b7 + d071008*b8 + d071009*b9

                  d2f_y%p(i,mesh_xy%ny-6,k) = 1.0_8*( m71*f%p(i,mesh_xy%ny  ,k)+ m72*f%p(i,mesh_xy%ny-1 ,k)+ m73*f%p(i,mesh_xy%ny-2 ,k) + &
                                                      m74*f%p(i,mesh_xy%ny-3,k)+ m75*f%p(i,mesh_xy%ny-4 ,k)+ m76*f%p(i,mesh_xy%ny-5 ,k) + &
                                                      m77*f%p(i,mesh_xy%ny-6,k)+ m78*f%p(i,mesh_xy%ny-7 ,k)+ m79*f%p(i,mesh_xy%ny-8 ,k) + &
                                                     m710*f%p(i,mesh_xy%ny-9,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-7 .and. mesh_xy%je>=mesh_xy%ny-7) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)
                  b8  = mesh_xy%Qi(3,i,mesh_xy%ny-7 ,k)*mesh_xy%J(i,mesh_xy%ny-7 ,k)
                  b9  = mesh_xy%Qi(3,i,mesh_xy%ny-8 ,k)*mesh_xy%J(i,mesh_xy%ny-8 ,k)
                  b10 = mesh_xy%Qi(3,i,mesh_xy%ny-9 ,k)*mesh_xy%J(i,mesh_xy%ny-9 ,k)
                  b11 = mesh_xy%Qi(3,i,mesh_xy%ny-10,k)*mesh_xy%J(i,mesh_xy%ny-10,k)

                  m81  = d080105*b5 + d080106*b6 + d080107*b7
                  m82  = d080205*b5 + d080206*b6 + d080207*b7
                  m83  = d080305*b5 + d080306*b6 + d080307*b7
                  m84  = d080405*b5 + d080406*b6 + d080407*b7
                  m85  = d080505*b5 + d080506*b6 + d080507*b7 + d080508*b8
                  m86  = d080605*b5 + d080606*b6 + d080607*b7 + d080608*b8 + d080609*b9
                  m87  = d080705*b5 + d080706*b6 + d080707*b7 + d080708*b8 + d080709*b9 + d080710*b10
                  m88  = d080805*b5 + d080806*b6 + d080807*b7 + d080808*b8 + d080809*b9 + d080810*b10 + d080811*b11
                  m89  = d080910*b10 + d080911*b11 + d080905*b5 + d080906*b6 + d080907*b7 + d080908*b8 + d080909*b9
                  m810 = d081010*b10 + d081011*b11 + d081007*b7 + d081008*b8 + d081009*b9
                  m811 = d081110*b10 + d081111*b11 + d081108*b8 + d081109*b9

                  d2f_y%p(i,mesh_xy%ny-7,k) = 1.0_8*( m81*f%p(i,mesh_xy%ny  ,k)+ m82*f%p(i,mesh_xy%ny-1 ,k)+ m83*f%p(i,mesh_xy%ny-2 ,k) + &
                                                      m84*f%p(i,mesh_xy%ny-3,k)+ m85*f%p(i,mesh_xy%ny-4 ,k)+ m86*f%p(i,mesh_xy%ny-5 ,k) + &
                                                      m87*f%p(i,mesh_xy%ny-6,k)+ m88*f%p(i,mesh_xy%ny-7 ,k)+ m89*f%p(i,mesh_xy%ny-8 ,k) + &
                                                     m810*f%p(i,mesh_xy%ny-9,k)+m811*f%p(i,mesh_xy%ny-10,k))
              end do
          end if
          if (mesh_xy%js<=mesh_xy%ny-8 .and. mesh_xy%je>=mesh_xy%ny-8) then
              do i = mesh_xy%is, mesh_xy%ie
                  b1  = mesh_xy%Qi(3,i,mesh_xy%ny   ,k)*mesh_xy%J(i,mesh_xy%ny   ,k)
                  b2  = mesh_xy%Qi(3,i,mesh_xy%ny-1 ,k)*mesh_xy%J(i,mesh_xy%ny-1 ,k)
                  b3  = mesh_xy%Qi(3,i,mesh_xy%ny-2 ,k)*mesh_xy%J(i,mesh_xy%ny-2 ,k)
                  b4  = mesh_xy%Qi(3,i,mesh_xy%ny-3 ,k)*mesh_xy%J(i,mesh_xy%ny-3 ,k)
                  b5  = mesh_xy%Qi(3,i,mesh_xy%ny-4 ,k)*mesh_xy%J(i,mesh_xy%ny-4 ,k)
                  b6  = mesh_xy%Qi(3,i,mesh_xy%ny-5 ,k)*mesh_xy%J(i,mesh_xy%ny-5 ,k)
                  b7  = mesh_xy%Qi(3,i,mesh_xy%ny-6 ,k)*mesh_xy%J(i,mesh_xy%ny-6 ,k)
                  b8  = mesh_xy%Qi(3,i,mesh_xy%ny-7 ,k)*mesh_xy%J(i,mesh_xy%ny-7 ,k)
                  b9  = mesh_xy%Qi(3,i,mesh_xy%ny-8 ,k)*mesh_xy%J(i,mesh_xy%ny-8 ,k)
                  b10 = mesh_xy%Qi(3,i,mesh_xy%ny-9 ,k)*mesh_xy%J(i,mesh_xy%ny-9 ,k)
                  b11 = mesh_xy%Qi(3,i,mesh_xy%ny-10,k)*mesh_xy%J(i,mesh_xy%ny-10,k)
                  b12 = mesh_xy%Qi(3,i,mesh_xy%ny-11,k)*mesh_xy%J(i,mesh_xy%ny-11,k)

                  m91  = d090105*b5 + d090106*b6 + d090107*b7
                  m92  = d090205*b5 + d090206*b6 + d090207*b7
                  m93  = d090305*b5 + d090306*b6 + d090307*b7
                  m94  = d090405*b5 + d090406*b6 + d090407*b7
                  m95  = d090505*b5 + d090506*b6 + d090507*b7 + d090508*b8
                  m96  = d090605*b5 + d090606*b6 + d090607*b7 + d090608*b8 + d090609*b9
                  m97  = d090705*b5 + d090706*b6 + d090707*b7 + d090708*b8 + d090709*b9 + d090710*b10
                  m98  = d090810*b10 + d090811*b11 + d090805*b5 + d090806*b6 + d090807*b7 + d090808*b8 + d090809*b9
                  m99  = d090910*b10 + d090911*b11 + d090912*b12 + d090905*b5 + d090906*b6 + d090907*b7 + d090908*b8 + d090909*b9
                  m910 = d091010*b10 + d091011*b11 + d091012*b12 + d091007*b7 + d091008*b8 + d091009*b9
                  m911 = d091110*b10 + d091111*b11 + d091112*b12 + d091108*b8 + d091109*b9
                  m912 = d091210*b10 + d091211*b11 + d091212*b12 + d091209*b9

                  d2f_y%p(i,mesh_xy%ny-8,k) = 1.0_8*( m91*f%p(i,mesh_xy%ny  ,k)+ m92*f%p(i,mesh_xy%ny-1 ,k)+ m93*f%p(i,mesh_xy%ny-2 ,k) + &
                                                      m94*f%p(i,mesh_xy%ny-3,k)+ m95*f%p(i,mesh_xy%ny-4 ,k)+ m96*f%p(i,mesh_xy%ny-5 ,k) + &
                                                      m97*f%p(i,mesh_xy%ny-6,k)+ m98*f%p(i,mesh_xy%ny-7 ,k)+ m99*f%p(i,mesh_xy%ny-8 ,k) + &
                                                     m910*f%p(i,mesh_xy%ny-9,k)+m911*f%p(i,mesh_xy%ny-10,k)+m912*f%p(i,mesh_xy%ny-11,k))
              end do
          end if
        end do

        do k = mesh_xy%ks, mesh_xy%ke
          if (mesh_xy%is==1) then
              do j = mesh_xy%js, mesh_xy%je
                  penalty = 43200.0_8/13649*(-2.0_8*d1f_y%p(1,j,k))
                  d2f_x%p(1,j,k) = d2f_x%p(1,j,k)-0.5_8*penalty
              end do
          end if
          if (mesh_xy%ie==mesh_xy%nx) then
              do j = mesh_xy%js, mesh_xy%je
                  penalty = 43200.0_8/13649*(2*d1f_y%p(mesh_xy%nx,j,k))
                  d2f_x%p(mesh_xy%nx,j,k) = d2f_x%p(mesh_xy%nx,j,k) -0.5_8*penalty
              end do
          end if

          if (mesh_xy%js==1) then
              do i = mesh_xy%is, mesh_xy%ie
                  penalty = 43200.0_8/13649*(-2*d1f_x%p(i,1,k))
                  d2f_x%p(i,1,k) = d2f_x%p(i,1,k) -0.5_8*penalty
              end do
          end if
          if (mesh_xy%je==mesh_xy%ny) then
              do i = mesh_xy%is, mesh_xy%ie
                  penalty = 43200.0_8/13649*(2*d1f_x%p(i,mesh_xy%ny,k))
                  d2f_x%p(i,mesh_xy%ny,k) = d2f_x%p(i,mesh_xy%ny,k) -0.5_8*penalty
              end do
          end if

        end do
        call sbp_d1_op%apply(d2f_yx, work, mesh_xy%ny, "y", d1f_x)
        call sbp_d1_op%apply(d2f_xy, work, mesh_xy%nx, "x", d1f_y)

        call fout%assign(1.0_8, d2f_x, &
                         1.0_8, d2f_y, mesh_xy)

        call fout%update(1.0_8, d2f_xy, &
                         1.0_8, d2f_yx, mesh_xy)


         do k = mesh_xy%ks, mesh_xy%ke
             do j = mesh_xy%js, mesh_xy%je
                 do i = mesh_xy%is, mesh_xy%ie
                     fout%p(i,j,k) = fout%p(i,j,k)/(mesh_xy%hx*scale)**2
                 end do
             end do
         end do

    end subroutine calc_laplace_tile

end module laplace_Ah_sbp63_narrow_mod
